(()=>{"use strict";var t={31552:(t,e,n)=>{n.d(e,{A:()=>u});var r=n(41034),a=(n(16280),n(76918),n(28706),n(26099),n(50788)),s=n.n(a),o=n(55129),i=n(89143),c=s().create({baseURL:"/api",timeout:1e4});c.interceptors.request.use(function(t){var e=localStorage.getItem("token")||o.A.getters.token;return e?(t.headers["Authorization"]="Bearer ".concat(e),console.log("请求 ".concat(t.url," 添加Authorization头: Bearer ").concat(e))):console.log("请求 ".concat(t.url," 没有token")),t},function(t){return console.error("请求错误:",t),Promise.reject(t)}),c.interceptors.response.use(function(t){var e=t.data;return 200!==e.code?((0,i.Message)({message:e.message||"请求失败",type:"error",duration:5e3}),401===e.code&&o.A.dispatch("logout").then(function(){location.reload()}),Promise.reject(new Error(e.message||"请求失败"))):t.data},function(t){if(console.error("响应错误:",t),t.response)switch(t.response.status){case 401:(0,i.Message)({message:"未授权，请重新登录",type:"error",duration:5e3}),o.A.dispatch("logout").then(function(){location.reload()});break;case 403:(0,i.Message)({message:"拒绝访问，请检查您的权限",type:"error",duration:5e3});break;case 404:(0,i.Message)({message:"请求的资源不存在",type:"error",duration:5e3});break;case 500:(0,i.Message)({message:"服务器内部错误",type:"error",duration:5e3});break;default:(0,i.Message)({message:t.response.data.message||"请求失败",type:"error",duration:5e3})}else(0,i.Message)({message:"网络错误，请检查您的网络连接",type:"error",duration:5e3});return Promise.reject(t)});const u={user:{login:function(t){return c.post("/auth/login",t)["catch"](function(t){throw console.error("Login API error:",t),new Error("请求失败")})},register:function(t){return c.post("/auth/register",t)},getInfo:function(){console.log("获取用户信息...");var t=localStorage.getItem("token");return t?c.get("/user/info").then(function(t){return console.log("获取用户信息成功:",t),t})["catch"](function(t){var e;return console.error("获取用户信息失败:",t),t.response?(console.error("错误状态码:",t.response.status),console.error("错误数据:",t.response.data)):t.request?console.error("请求已发送但未收到响应:",t.request):console.error("请求配置错误:",t.message),t.config&&console.error("请求配置:",t.config),Promise.reject(new Error("获取用户信息失败: "+((null===(e=t.response)||void 0===e||null===(e=e.data)||void 0===e?void 0:e.message)||t.message||"请求失败")))}):Promise.reject(new Error("未登录，无法获取用户信息"))},updateInfo:function(t){return c.put("/user/info",t)},changePassword:function(t){return c.put("/user/password",t)},getList:function(t){return c.get("/user/list",{params:t})},updateStatus:function(t,e){return c.put("/user/status?id=".concat(t,"&status=").concat(e))},updateRole:function(t,e){return c.put("/user/role?id=".concat(t,"&role=").concat(e))}},article:{getList:function(t){return c.get("/article/list",{params:t})},getMyList:function(t){return c.get("/article/my",{params:t})},getPendingList:function(t){return c.get("/article/pending",{params:t})},getDetail:function(t){return c.get("/article/".concat(t))},add:function(t){return c.post("/article",t)},update:function(t,e){return c.put("/article/".concat(t),e)},delete:function(t){return c["delete"]("/article/".concat(t))},approve:function(t){return c.put("/article/approve/".concat(t))},reject:function(t){return c.put("/article/reject/".concat(t))},like:function(t){return c.post("/article/".concat(t,"/like"))},checkLikeStatus:function(t){return c.get("/article/".concat(t,"/like/status"))}},category:{getAll:function(){return c.get("/category/list")},getList:function(t){return c.get("/admin/categories",{params:t})},add:function(t){return c.post("/admin/categories",t)},update:function(t,e){return c.put("/admin/categories/".concat(t),e)},delete:function(t){return c["delete"]("/admin/categories/".concat(t))}},tag:{getAll:function(){return c.get("/tags")},getList:function(t){return c.get("/admin/tags",{params:t})},add:function(t){return c.post("/admin/tags",t)},update:function(t,e){return c.put("/admin/tags/".concat(t),e)},delete:function(t){return c["delete"]("/admin/tags/".concat(t))}},comment:{getByArticle:function(t,e){return c.get("/comment/list?articleId=".concat(t),{params:e})},add:function(t){return c.post("/comment",t)},getTree:function(t){return c.get("/comment/tree?articleId=".concat(t))},getList:function(t){return c.get("/admin/comments",{params:t})},updateStatus:function(t,e){return c.put("/admin/comments/".concat(t,"/status"),{status:e})},delete:function(t){return c["delete"]("/admin/comments/".concat(t))}},photo:{getList:function(t){return c.get("/photo/list",{params:t})},getCategories:function(){return c.get("/photo/category/list")},getAdminList:function(t){return c.get("/admin/photos",{params:t})},add:function(t){return c.post("/admin/photos",t)},update:function(t,e){return c.put("/admin/photos/".concat(t),e)},delete:function(t){return c["delete"]("/admin/photos/".concat(t))},getCategoryList:function(t){return c.get("/admin/photo/categories",{params:t})},addCategory:function(t){return c.post("/admin/photo/categories",t)},updateCategory:function(t,e){return c.put("/admin/photo/categories/".concat(t),e)},deleteCategory:function(t){return c["delete"]("/admin/photo/categories/".concat(t))}},message:{getList:function(t){return c.get("/message/list",{params:t})},getTree:function(){return c.get("/message/tree")},add:function(t){return c.post("/message",t)},reply:function(t){return c.post("/message/reply",t)},like:function(t){return c.post("/message/".concat(t,"/like"))},getAdminList:function(t){return c.get("/admin/messages",{params:t})},getDetail:function(t){return c.get("/admin/messages/".concat(t))},updateStatus:function(t,e){return c.put("/admin/messages/".concat(t,"/status"),{status:e})},adminReply:function(t){return c.post("/admin/messages/reply",t)},delete:function(t){return c["delete"]("/admin/messages/".concat(t))},update:function(t,e){return c.put("/admin/messages",e)},batchDelete:function(t){return c["delete"]("/admin/messages/batch",{data:t})},getRecentMessages:function(t){return c.get("/message/list",{params:(0,r.A)((0,r.A)({},t),{},{current:1,size:5})})}},friendLink:{getList:function(){return c.get("/friend-links")},apply:function(t){return c.post("/friend-links/apply",t)},getAdminList:function(t){return c.get("/admin/friend-links",{params:t})},getDetail:function(t){return c.get("/admin/friend-links/".concat(t))},add:function(t){return c.post("/admin/friend-links",t)},update:function(t){return c.put("/admin/friend-links",t)},delete:function(t){return c["delete"]("/admin/friend-links/".concat(t))},batchDelete:function(t){return c["delete"]("/admin/friend-links/batch",{data:t})},audit:function(t,e){return c.put("/admin/friend-links/".concat(t,"/audit?status=").concat(e))}},system:{getPublicSettings:function(){return c.get("/settings/public")},getSettings:function(){return c.get("/admin/settings")},updateSettings:function(t){return c.put("/admin/settings",t)},initSettings:function(){return c.post("/admin/settings/init")},getStatistics:function(){return c.get("/admin/statistics")}},upload:function(t){var e=new FormData;return e.append("file",t),c.post("/admin/upload",e,{headers:{"Content-Type":"multipart/form-data"}})},adminUser:{getList:function(t){return c.get("/admin/users",{params:t})},getById:function(t){return c.get("/admin/users/".concat(t))},update:function(t,e){return c.put("/admin/users/".concat(t),e)},create:function(t){return c.post("/admin/users",t)},updateStatus:function(t,e){return c.put("/admin/users/".concat(t,"/status?status=").concat(e))},updateRole:function(t,e){return c.put("/admin/users/".concat(t,"/role?role=").concat(e))},resetPassword:function(t){return c.put("/admin/users/".concat(t,"/reset-password"))},delete:function(t){return c["delete"]("/admin/users/".concat(t))}},statistics:{getSiteStatistics:function(){return c.get("/statistics/site")},getTotalViews:function(){return c.get("/statistics/total-views")}}}},55129:(t,e,n)=>{n.d(e,{A:()=>u});var r=n(20908),a=n(30388),s=(n(16280),n(76918),n(60739),n(33110),n(79432),n(26099),n(66848)),o=n(93518),i=n(31552);s["default"].use(o.Ay);var c=new o.Ay.Store({state:{token:localStorage.getItem("token")||"",user:JSON.parse(localStorage.getItem("user"))||null},getters:{token:function(t){return t.token},user:function(t){return t.user},isAuthenticated:function(t){return!!t.token},isAdmin:function(t){return console.log("User role:",t.user?t.user.role:"No user"),t.user&&0===t.user.role}},mutations:{SET_TOKEN:function(t,e){t.token=e,localStorage.setItem("token",e)},SET_USER:function(t,e){t.user=e,localStorage.setItem("user",JSON.stringify(e))},CLEAR_AUTH:function(t){t.token="",t.user=null,localStorage.removeItem("token"),localStorage.removeItem("user")}},actions:{login:function(t,e){return(0,a.A)((0,r.A)().m(function n(){var a,s,o,c,u,l,d;return(0,r.A)().w(function(n){while(1)switch(n.p=n.n){case 0:return a=t.commit,s=t.dispatch,n.p=1,n.n=2,i.A.user.login(e);case 2:if(o=n.v,200!==o.code){n.n=7;break}return c=o.data.token,a("SET_TOKEN",c),n.p=3,n.n=4,s("getUserInfo");case 4:u=n.v,console.log("Login successful, user info:",u),n.n=6;break;case 5:n.p=5,l=n.v,console.error("Failed to get user info, but login successful:",l),a("SET_USER",{id:null,username:e.username,nickname:e.username,avatar:"https://cube.elemecdn.com/3/7c/3ea6beec64369c2642b92c6726f1epng.png",role:1});case 6:return n.a(2,!0);case 7:throw new Error(o.message||"登录失败");case 8:n.n=10;break;case 9:throw n.p=9,d=n.v,console.error("Login error:",d),d;case 10:return n.a(2)}},n,null,[[3,5],[1,9]])}))()},register:function(t,e){return(0,a.A)((0,r.A)().m(function t(){var n;return(0,r.A)().w(function(t){while(1)switch(t.n){case 0:return t.n=1,i.A.user.register(e);case 1:if(n=t.v,200!==n.code){t.n=2;break}return t.a(2,!0);case 2:throw new Error(n.message||"注册失败");case 3:return t.a(2)}},t)}))()},getUserInfo:function(t){return(0,a.A)((0,r.A)().m(function e(){var n,a,s,o,c,u,l,d,m,g,f,p;return(0,r.A)().w(function(e){while(1)switch(e.p=e.n){case 0:if(n=t.commit,a=t.state,e.p=1,s=localStorage.getItem("token")||a.token,s){e.n=2;break}return console.warn("No token available, cannot get user info"),e.a(2,null);case 2:return a.token||n("SET_TOKEN",s),console.log("Getting user info with token:",s),e.n=3,i.A.user.getInfo();case 3:if(o=e.v,console.log("getUserInfo response:",o),!o||200!==o.code){e.n=4;break}return c=o.data,console.log("User info received:",c),console.log("User role:",c.role),n("SET_USER",c),e.a(2,c);case 4:if(console.warn("Failed to get user info:",o?o.message:"No response"),u=localStorage.getItem("user"),!u){e.n=7;break}return e.p=5,l=JSON.parse(u),console.log("Using cached user info:",l),n("SET_USER",l),e.a(2,l);case 6:e.p=6,g=e.v,console.error("Error parsing cached user:",g);case 7:return e.a(2,null);case 8:e.n=13;break;case 9:if(e.p=9,f=e.v,console.error("Error getting user info:",f),d=localStorage.getItem("user"),!d){e.n=12;break}return e.p=10,m=JSON.parse(d),console.log("Using cached user info after error:",m),n("SET_USER",m),e.a(2,m);case 11:e.p=11,p=e.v,console.error("Error parsing cached user after error:",p);case 12:return!f.response||401!==f.response.status&&403!==f.response.status||(console.warn("Authentication error, clearing token"),n("CLEAR_AUTH")),e.a(2,null);case 13:return e.a(2)}},e,null,[[10,11],[5,6],[1,9]])}))()},updateUserInfo:function(t,e){return(0,a.A)((0,r.A)().m(function n(){var a,s;return(0,r.A)().w(function(n){while(1)switch(n.n){case 0:return a=t.commit,n.n=1,i.A.user.updateInfo(e);case 1:if(s=n.v,200!==s.code){n.n=2;break}return a("SET_USER",s.data),n.a(2,!0);case 2:throw new Error(s.message||"更新用户信息失败");case 3:return n.a(2)}},n)}))()},changePassword:function(t,e){return(0,a.A)((0,r.A)().m(function t(){var n;return(0,r.A)().w(function(t){while(1)switch(t.n){case 0:return t.n=1,i.A.user.changePassword(e);case 1:if(n=t.v,200!==n.code){t.n=2;break}return t.a(2,!0);case 2:throw new Error(n.message||"修改密码失败");case 3:return t.a(2)}},t)}))()},logout:function(t){var e=t.commit;return e("CLEAR_AUTH"),Promise.resolve()}}});const u=c},73200:(t,e,n)=>{n(23792),n(3362),n(69085),n(9391);var r=n(66848),a=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"app"}},[e("nav-bar"),e("div",{staticClass:"main-content"},[e("router-view")],1)],1)},s=[],o=n(20908),i=n(30388),c=n(41034),u=(n(79432),n(93518)),l=function(){var t=this,e=t._self._c;return e("header",{staticClass:"header"},[e("div",{staticClass:"nav-container"},[e("div",{staticClass:"logo"},[t._v(t._s(t.siteSettings.site_title||"博客系统"))]),e("div",{staticClass:"nav-links"},[e("router-link",{staticClass:"nav-item",attrs:{to:"/",exact:""}},[t._v("首页")]),e("router-link",{staticClass:"nav-item",attrs:{to:"/article"}},[t._v("文章")]),t.isAuthenticated?[e("router-link",{staticClass:"nav-item",attrs:{to:"/write"}},[t._v("写作")]),e("router-link",{staticClass:"nav-item",attrs:{to:"/photos"}},[t._v("相册")]),e("router-link",{staticClass:"nav-item",attrs:{to:"/message"}},[t._v("留言")])]:t._e(),e("router-link",{staticClass:"nav-item",attrs:{to:"/friends"}},[t._v("友链")]),e("router-link",{staticClass:"nav-item",attrs:{to:"/about"}},[t._v("关于")]),t.isAdmin?e("router-link",{staticClass:"nav-item admin-link",attrs:{to:"/admin"}},[e("i",{staticClass:"el-icon-setting"}),t._v(" 管理 ")]):t._e()],2),e("div",{staticClass:"user-section"},[t.isAuthenticated&&t.user?e("div",{staticClass:"user-avatar"},[e("el-dropdown",{attrs:{trigger:"click"},on:{command:t.handleCommand}},[e("img",{staticClass:"avatar",attrs:{src:t.user.avatar,alt:"用户头像"}}),e("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[e("el-dropdown-item",{attrs:{command:"profile"}},[t._v("个人中心")]),e("el-dropdown-item",{attrs:{command:"logout"}},[t._v("退出登录")])],1)],1)],1):e("div",[e("router-link",{attrs:{to:"/login"}},[e("el-button",{attrs:{type:"primary",size:"small",round:""}},[t._v("登录")])],1)],1)])])])},d=[],m=(n(44114),n(31552));const g={name:"NavBar",data:function(){return{siteSettings:{site_title:"博客系统",site_description:"记录生活，分享思考"}}},computed:(0,c.A)((0,c.A)({},(0,u.L8)(["user","isAuthenticated"])),{},{isAdmin:function(){return this.user&&0===this.user.role}}),created:function(){this.loadSiteSettings()},methods:(0,c.A)((0,c.A)({},(0,u.i0)(["logout"])),{},{loadSiteSettings:function(){var t=this;return(0,i.A)((0,o.A)().m(function e(){var n,r;return(0,o.A)().w(function(e){while(1)switch(e.p=e.n){case 0:return e.p=0,e.n=1,m.A.system.getPublicSettings();case 1:n=e.v,200===n.code&&(t.siteSettings=n.data),e.n=3;break;case 2:e.p=2,r=e.v,console.log("加载系统设置失败，使用默认设置:",r);case 3:return e.a(2)}},e,null,[[0,2]])}))()},handleCommand:function(t){"profile"===t?this.$router.push("/user/profile"):"logout"===t&&(this.logout(),this.$message.success("已退出登录"),this.$router.push("/")["catch"](function(){}))}})},f=g;var p=n(81656),h=(0,p.A)(f,l,d,!1,null,"34e30ef3",null);const v=h.exports,b={name:"App",components:{NavBar:v},computed:(0,c.A)({},(0,u.L8)(["isAuthenticated","isAdmin"])),created:function(){this.checkAuthStatus()},methods:{checkAuthStatus:function(){var t=this;return(0,i.A)((0,o.A)().m(function e(){var n,r,a,s;return(0,o.A)().w(function(e){while(1)switch(e.p=e.n){case 0:if(n=localStorage.getItem("token"),!n){e.n=5;break}return console.log("Token found in localStorage, attempting to get user info"),e.p=1,t.$store.commit("SET_TOKEN",n),e.n=2,t.$store.dispatch("getUserInfo");case 2:r=e.v,r||(console.warn("Failed to get user info, but will continue with cached data if available"),a=JSON.parse(localStorage.getItem("user")),a&&t.$store.commit("SET_USER",a)),e.n=4;break;case 3:e.p=3,s=e.v,console.error("Error during auth check:",s);case 4:e.n=6;break;case 5:console.log("No token found, user is not authenticated");case 6:return e.a(2)}},e,null,[[1,3]])}))()}}},A=b;var C=(0,p.A)(A,a,s,!1,null,null,null);const k=C.exports;n(15086),n(18111),n(13579),n(26099),n(47764),n(62953);var _=n(56178),w=function(){var t=this,e=t._self._c;return e("div",{staticClass:"home"},[e("header",{staticClass:"header"},[e("div",{staticClass:"nav-container"},[e("div",{staticClass:"logo"},[t._v(t._s(t.siteSettings.site_title||"博客系统"))]),e("div",{staticClass:"nav-links"},[e("router-link",{staticClass:"nav-item",attrs:{to:"/"}},[t._v("首页")]),e("router-link",{staticClass:"nav-item",attrs:{to:"/article"}},[t._v("文章")]),t.isAuthenticated?[e("router-link",{staticClass:"nav-item",attrs:{to:"/write"}},[t._v("写作")]),e("router-link",{staticClass:"nav-item",attrs:{to:"/photos"}},[t._v("相册")]),e("router-link",{staticClass:"nav-item",attrs:{to:"/message"}},[t._v("留言")])]:t._e(),e("router-link",{staticClass:"nav-item",attrs:{to:"/friends"}},[t._v("友链")]),e("router-link",{staticClass:"nav-item",attrs:{to:"/about"}},[t._v("关于")]),t.isAdmin?e("router-link",{staticClass:"nav-item admin-link",attrs:{to:"/admin"}},[e("i",{staticClass:"el-icon-setting"}),t._v(" 管理 ")]):t._e()],2),e("div",{staticClass:"user-section"},[t.isAuthenticated&&t.user?e("div",{staticClass:"user-avatar"},[e("el-dropdown",{attrs:{trigger:"click"},on:{command:t.handleCommand}},[e("img",{staticClass:"avatar",attrs:{src:t.user.avatar,alt:"用户头像"}}),e("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[e("el-dropdown-item",{attrs:{command:"profile"}},[t._v("个人中心")]),e("el-dropdown-item",{attrs:{command:"logout"}},[t._v("退出登录")])],1)],1)],1):e("div",[e("router-link",{attrs:{to:"/login"}},[e("el-button",{attrs:{type:"primary",size:"small",round:""}},[t._v("登录")])],1)],1)])])]),e("section",{staticClass:"hero-section"},[e("div",{staticClass:"hero-background"},[e("div",{staticClass:"hero-overlay"}),e("div",{staticClass:"hero-content"},[e("h1",{staticClass:"hero-title"},[t._v(t._s(t.siteSettings.site_title||"博客系统"))]),e("p",{staticClass:"hero-subtitle"},[t._v(t._s(t.siteSettings.site_description||"记录生活，分享思考"))]),e("div",{staticClass:"hero-actions"},[e("router-link",{attrs:{to:"/article"}},[e("el-button",{attrs:{type:"primary",size:"large",round:""}},[t._v("开始阅读")])],1),t.isAuthenticated?e("router-link",{attrs:{to:"/write"}},[e("el-button",{attrs:{type:"success",size:"large",round:""}},[t._v("开始创作")])],1):t._e()],1)]),t._m(0)])]),e("main",{staticClass:"main-content"},[e("div",{staticClass:"container"},[e("div",{staticClass:"stats-section"},[e("div",{staticClass:"stats-grid"},[e("div",{staticClass:"stat-card"},[t._m(1),e("div",{staticClass:"stat-info"},[e("div",{staticClass:"stat-number"},[t._v(t._s(t.articleCount))]),e("div",{staticClass:"stat-label"},[t._v("文章")])])]),e("div",{staticClass:"stat-card"},[t._m(2),e("div",{staticClass:"stat-info"},[e("div",{staticClass:"stat-number"},[t._v(t._s(t.categoryCount))]),e("div",{staticClass:"stat-label"},[t._v("分类")])])]),e("div",{staticClass:"stat-card"},[t._m(3),e("div",{staticClass:"stat-info"},[e("div",{staticClass:"stat-number"},[t._v(t._s(t.formatNumber(t.viewCount)))]),e("div",{staticClass:"stat-label"},[t._v("访问")])])])])]),e("div",{staticClass:"articles-section"},[e("div",{staticClass:"section-header"},[t._m(4),e("router-link",{staticClass:"view-all",attrs:{to:"/article"}},[t._v(" 查看全部 "),e("i",{staticClass:"el-icon-arrow-right"})])],1),t.loading?e("div",{staticClass:"loading-container"},[e("el-skeleton",{attrs:{rows:3,animated:""}})],1):0===t.articles.length?e("div",{staticClass:"empty-state"},[e("i",{staticClass:"el-icon-document"}),e("p",[t._v("暂无文章")]),t.isAuthenticated?e("router-link",{attrs:{to:"/write"}},[e("el-button",{attrs:{type:"primary",round:""}},[t._v("写第一篇文章")])],1):t._e()],1):e("div",{staticClass:"articles-grid"},t._l(t.articles,function(n){return e("article",{key:n.id,staticClass:"article-card"},[e("div",{staticClass:"article-image"},[e("img",{attrs:{src:n.coverImage||"/default-cover.jpg",alt:n.title}}),e("div",{staticClass:"article-category"},[t._v(t._s(n.categoryName||"未分类"))])]),e("div",{staticClass:"article-content"},[e("h3",{staticClass:"article-title"},[e("router-link",{attrs:{to:"/article/".concat(n.id)}},[t._v(t._s(n.title))])],1),e("p",{staticClass:"article-summary"},[t._v(t._s(n.summary||"暂无摘要..."))]),e("div",{staticClass:"article-meta"},[e("span",{staticClass:"meta-item"},[e("i",{staticClass:"el-icon-time"}),t._v(" "+t._s(t.formatDate(n.createTime))+" ")]),e("span",{staticClass:"meta-item"},[e("i",{staticClass:"el-icon-view"}),t._v(" "+t._s(n.viewCount||0)+" ")]),e("span",{staticClass:"meta-item"},[e("i",{staticClass:"el-icon-chat-line-round"}),t._v(" "+t._s(n.commentCount||0)+" ")])])])])}),0)])])]),e("footer",{staticClass:"footer"},[e("div",{staticClass:"container"},[e("div",{staticClass:"footer-content"},[e("div",{staticClass:"footer-info"},[e("h3",[t._v(t._s(t.siteSettings.site_title||"博客系统"))]),e("p",[t._v(t._s(t.siteSettings.site_description||"记录生活，分享思考"))])]),e("div",{staticClass:"footer-links"},[e("router-link",{attrs:{to:"/about"}},[t._v("关于我们")]),e("router-link",{attrs:{to:"/friends"}},[t._v("友情链接")]),t.isAuthenticated?e("router-link",{attrs:{to:"/message"}},[t._v("留言反馈")]):t._e()],1)]),e("div",{staticClass:"footer-bottom"},[e("p",[t._v("© 2025 "+t._s(t.siteSettings.site_title||"博客系统")+". All rights reserved.")])])])])])},S=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"scroll-indicator"},[e("i",{staticClass:"el-icon-arrow-down"})])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"stat-icon articles"},[e("i",{staticClass:"el-icon-document"})])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"stat-icon categories"},[e("i",{staticClass:"el-icon-folder"})])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"stat-icon views"},[e("i",{staticClass:"el-icon-view"})])},function(){var t=this,e=t._self._c;return e("h2",{staticClass:"section-title"},[e("i",{staticClass:"el-icon-document"}),t._v(" 最新文章 ")])}];n(76918),n(28706),n(72712),n(23288),n(62010),n(18237),n(9868),n(38781),n(68156);const y={name:"Home",data:function(){return{articleCount:0,categoryCount:0,totalViews:0,viewCount:0,articles:[],loading:!0,siteSettings:{site_title:"博客系统",site_description:"记录生活，分享思考",site_author:"博主",site_keywords:"blog,博客,技术分享"}}},computed:(0,c.A)((0,c.A)({},(0,u.L8)(["user","isAuthenticated"])),{},{isAdmin:function(){return this.user&&0===this.user.role}}),mounted:function(){var t=this;return(0,i.A)((0,o.A)().m(function e(){var n,r;return(0,o.A)().w(function(e){while(1)switch(e.p=e.n){case 0:if(n=localStorage.getItem("token"),!n||t.user){e.n=4;break}return e.p=1,e.n=2,t.$store.dispatch("getUserInfo");case 2:e.n=4;break;case 3:e.p=3,r=e.v,console.error("Failed to get user info:",r);case 4:return e.n=5,t.loadSiteSettings();case 5:return e.n=6,t.fetchData();case 6:return e.a(2)}},e,null,[[1,3]])}))()},methods:(0,c.A)((0,c.A)({},(0,u.i0)(["logout"])),{},{loadSiteSettings:function(){var t=this;return(0,i.A)((0,o.A)().m(function e(){var n,r;return(0,o.A)().w(function(e){while(1)switch(e.p=e.n){case 0:return e.p=0,e.n=1,m.A.system.getPublicSettings();case 1:n=e.v,200===n.code&&(t.siteSettings=n.data,t.siteSettings.site_title&&(document.title=t.siteSettings.site_title),t.updateMetaTags()),e.n=3;break;case 2:e.p=2,r=e.v,console.log("加载系统设置失败，使用默认设置:",r);case 3:return e.a(2)}},e,null,[[0,2]])}))()},updateMetaTags:function(){var t=function(t,e){var n=document.querySelector('meta[name="'.concat(t,'"]'));n||(n=document.createElement("meta"),n.name=t,document.head.appendChild(n)),n.content=e};this.siteSettings.site_description&&t("description",this.siteSettings.site_description),this.siteSettings.site_keywords&&t("keywords",this.siteSettings.site_keywords),this.siteSettings.site_author&&t("author",this.siteSettings.site_author)},fetchData:function(){var t=this;return(0,i.A)((0,o.A)().m(function e(){var n,r,a;return(0,o.A)().w(function(e){while(1)switch(e.p=e.n){case 0:return e.p=0,t.loading=!0,e.n=1,m.A.article.getList({current:1,size:6});case 1:return n=e.v,200===n.code&&(t.articles=n.data.records||[],t.articleCount=n.data.total||0),e.p=2,e.n=3,m.A.category.getAll();case 3:r=e.v,200===r.code&&(t.categoryCount=r.data.length||0),e.n=5;break;case 4:e.p=4,e.v,t.categoryCount=5;case 5:return e.n=6,t.fetchTotalViewCount();case 6:e.n=8;break;case 7:e.p=7,a=e.v,console.error("获取数据失败:",a);case 8:return e.p=8,t.loading=!1,e.f(8);case 9:return e.a(2)}},e,null,[[2,4],[0,7,8,9]])}))()},fetchTotalViewCount:function(){var t=this;return(0,i.A)((0,o.A)().m(function e(){var n,r,a;return(0,o.A)().w(function(e){while(1)switch(e.p=e.n){case 0:return e.p=0,e.n=1,m.A.article.getList({current:1,size:1e3});case 1:n=e.v,200===n.code&&(r=n.data.records||[],t.viewCount=r.reduce(function(t,e){return t+(e.viewCount||0)},0)),e.n=3;break;case 2:e.p=2,a=e.v,console.error("获取访问量统计失败:",a),t.viewCount=0;case 3:return e.a(2)}},e,null,[[0,2]])}))()},handleCommand:function(t){"profile"===t?this.$router.push("/user/profile"):"logout"===t&&(this.logout(),this.$message.success("已退出登录"),this.$router.push("/")["catch"](function(){}))},formatDate:function(t){if(!t)return"";var e=new Date(t);return"".concat(e.getFullYear(),"-").concat(String(e.getMonth()+1).padStart(2,"0"),"-").concat(String(e.getDate()).padStart(2,"0"))},formatNumber:function(t){return t>=1e4?(t/1e4).toFixed(1)+"w":t>=1e3?(t/1e3).toFixed(1)+"k":t.toString()}})},E=y;var T=(0,p.A)(E,w,S,!1,null,"33b7057e",null);const L=T.exports;var I=n(55129);r["default"].use(_.Ay);var U=[{path:"/",name:"Home",component:L},{path:"/about",name:"About",component:function(){return n.e(766).then(n.bind(n,56766))}},{path:"/article",name:"Article",component:function(){return n.e(685).then(n.bind(n,20685))}},{path:"/article/:id",name:"ArticleDetail",component:function(){return n.e(9).then(n.bind(n,64009))}},{path:"/photos",name:"Photos",component:function(){return n.e(986).then(n.bind(n,35986))}},{path:"/message",name:"Message",component:function(){return n.e(48).then(n.bind(n,25048))}},{path:"/friends",name:"Friends",component:function(){return n.e(313).then(n.bind(n,2313))}},{path:"/write",name:"WriteArticle",component:function(){return n.e(512).then(n.bind(n,86512))},meta:{requiresAuth:!0}},{path:"/login",name:"Login",component:function(){return n.e(552).then(n.bind(n,17552))},meta:{guest:!0}},{path:"/user/profile",name:"UserProfile",component:function(){return n.e(458).then(n.bind(n,11458))},meta:{requiresAuth:!0}},{path:"/admin",component:function(){return n.e(264).then(n.bind(n,13264))},meta:{requiresAuth:!0,requiresAdmin:!0},children:[{path:"",name:"Dashboard",component:function(){return n.e(561).then(n.bind(n,33561))},meta:{title:"控制台"}},{path:"article",name:"AdminArticle",component:function(){return n.e(677).then(n.bind(n,37677))},meta:{title:"文章管理"}},{path:"article-review",name:"ArticleReview",component:function(){return n.e(870).then(n.bind(n,70870))},meta:{title:"文章审核"}},{path:"category",name:"AdminCategory",component:function(){return n.e(278).then(n.bind(n,36278))},meta:{title:"分类管理"}},{path:"tag",name:"AdminTag",component:function(){return n.e(706).then(n.bind(n,6325))},meta:{title:"标签管理"}},{path:"comment",name:"AdminComment",component:function(){return n.e(858).then(n.bind(n,33858))},meta:{title:"评论管理"}},{path:"photo",name:"AdminPhoto",component:function(){return n.e(928).then(n.bind(n,72928))},meta:{title:"照片管理"}},{path:"photo-category",name:"AdminPhotoCategory",component:function(){return n.e(128).then(n.bind(n,56128))},meta:{title:"相册分类"}},{path:"message",name:"AdminMessage",component:function(){return n.e(330).then(n.bind(n,19330))},meta:{title:"留言管理"}},{path:"friend",name:"AdminFriend",component:function(){return n.e(289).then(n.bind(n,46289))},meta:{title:"友链管理"}},{path:"user",name:"AdminUser",component:function(){return n.e(476).then(n.bind(n,61476))},meta:{title:"用户管理"}},{path:"setting",name:"AdminSetting",component:function(){return n.e(849).then(n.bind(n,8849))},meta:{title:"系统设置"}},{path:"friend-links",name:"FriendLinkManagement",component:function(){return n.e(289).then(n.bind(n,46289))},meta:{title:"友链管理",requiresAuth:!0,requiresAdmin:!0}},{path:"users",name:"UserManagement",component:function(){return n.e(476).then(n.bind(n,61476))},meta:{title:"用户管理",requiresAuth:!0,requiresAdmin:!0}}]},{path:"*",redirect:"/"}],N=new _.Ay({mode:"history",base:"/",routes:U,scrollBehavior:function(){return{x:0,y:0}}});N.beforeEach(function(){var t=(0,i.A)((0,o.A)().m(function t(e,n,r){var a,s,i,c,u,l,d;return(0,o.A)().w(function(t){while(1)switch(t.p=t.n){case 0:if(a=localStorage.getItem("token"),s=e.matched.some(function(t){return t.meta.requiresAdmin}),i=e.matched.some(function(t){return t.meta.guest}),c=e.matched.some(function(t){return t.meta.requiresAuth}),console.log("Route guard - Path:",e.path),console.log("Route guard - Token exists:",!!a),console.log("Route guard - Requires auth:",c),console.log("Route guard - Is guest:",i),"/login"!==e.path){t.n=1;break}return"true"===e.query.force?(console.log("Force login requested, clearing auth and accessing login page"),I.A.commit("CLEAR_AUTH"),r()):a?(console.log("Already authenticated, redirecting to home"),r("/")):(console.log("Accessing login page"),r()),t.a(2);case 1:if(!c||a){t.n=2;break}return console.log("Authentication required but no token, redirecting to login"),r("/login"),t.a(2);case 2:if(!a||I.A.state.user){t.n=6;break}return console.log("Token found but no user info, attempting to get user info"),t.p=3,t.n=4,I.A.dispatch("getUserInfo");case 4:t.n=6;break;case 5:if(t.p=5,d=t.v,console.error("Failed to get user info in route guard:",d),!c){t.n=6;break}return console.log("Failed to get user info for protected route, redirecting to login"),localStorage.removeItem("token"),r("/login"),t.a(2);case 6:if(!s){t.n=7;break}if(u=I.A.state.user,l=u&&0===u.role,l){t.n=7;break}return console.log("Admin required but user is not admin, redirecting to home"),r("/"),t.a(2);case 7:console.log("Navigation allowed"),r();case 8:return t.a(2)}},t,null,[[3,5]])}));return function(e,n,r){return t.apply(this,arguments)}}());const P=N;var O=n(89143),R=n.n(O);r["default"].use(R()),r["default"].config.productionTip=!1,new r["default"]({router:P,store:I.A,render:function(t){return t(k)}}).$mount("#app")}},e={};function n(r){var a=e[r];if(void 0!==a)return a.exports;var s=e[r]={id:r,loaded:!1,exports:{}};return t[r].call(s.exports,s,s.exports,n),s.loaded=!0,s.exports}n.m=t,(()=>{n.amdO={}})(),(()=>{var t=[];n.O=(e,r,a,s)=>{if(!r){var o=1/0;for(l=0;l<t.length;l++){for(var[r,a,s]=t[l],i=!0,c=0;c<r.length;c++)(!1&s||o>=s)&&Object.keys(n.O).every(t=>n.O[t](r[c]))?r.splice(c--,1):(i=!1,s<o&&(o=s));if(i){t.splice(l--,1);var u=a();void 0!==u&&(e=u)}}return e}s=s||0;for(var l=t.length;l>0&&t[l-1][2]>s;l--)t[l]=t[l-1];t[l]=[r,a,s]}})(),(()=>{n.n=t=>{var e=t&&t.__esModule?()=>t["default"]:()=>t;return n.d(e,{a:e}),e}})(),(()=>{n.d=(t,e)=>{for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})}})(),(()=>{n.f={},n.e=t=>Promise.all(Object.keys(n.f).reduce((e,r)=>(n.f[r](t,e),e),[]))})(),(()=>{n.u=t=>"js/"+t+"."+{9:"0286d1be",48:"2bddbd72",128:"78110bb0",264:"002d091e",278:"8c39e60d",289:"665b4609",313:"a83409c1",330:"834306d4",458:"11b21f8d",476:"f651da2e",512:"a28448bd",552:"a3cad218",561:"6b5a17c6",677:"bdfacd25",685:"d1fdbd91",706:"76a27ecb",766:"0b4759b2",849:"9f6fc56f",858:"9877768f",870:"5467052a",928:"0f240d9c",986:"614029b5"}[t]+".js"})(),(()=>{n.miniCssF=t=>"css/"+t+"."+{9:"30ada873",48:"a577b8d4",128:"4cafa03c",264:"8cd06cea",278:"fea316c4",289:"4b91edaa",313:"698e75e1",330:"ea017e83",458:"aa6b4597",476:"d236bde9",512:"2cb46ad9",552:"8718c50a",561:"4bc5c025",677:"992b3cc9",685:"a54e7308",706:"ce1e872e",766:"26556ab3",849:"999a9686",858:"e96ae6eb",870:"41d7014a",928:"24cff7bb",986:"69eb0f20"}[t]+".css"})(),(()=>{n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()})(),(()=>{n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e)})(),(()=>{var t={},e="blog-frontend:";n.l=(r,a,s,o)=>{if(t[r])t[r].push(a);else{var i,c;if(void 0!==s)for(var u=document.getElementsByTagName("script"),l=0;l<u.length;l++){var d=u[l];if(d.getAttribute("src")==r||d.getAttribute("data-webpack")==e+s){i=d;break}}i||(c=!0,i=document.createElement("script"),i.charset="utf-8",i.timeout=120,n.nc&&i.setAttribute("nonce",n.nc),i.setAttribute("data-webpack",e+s),i.src=r),t[r]=[a];var m=(e,n)=>{i.onerror=i.onload=null,clearTimeout(g);var a=t[r];if(delete t[r],i.parentNode&&i.parentNode.removeChild(i),a&&a.forEach(t=>t(n)),e)return e(n)},g=setTimeout(m.bind(null,void 0,{type:"timeout",target:i}),12e4);i.onerror=m.bind(null,i.onerror),i.onload=m.bind(null,i.onload),c&&document.head.appendChild(i)}}})(),(()=>{n.r=t=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}})(),(()=>{n.nmd=t=>(t.paths=[],t.children||(t.children=[]),t)})(),(()=>{n.p="/"})(),(()=>{if("undefined"!==typeof document){var t=(t,e,r,a,s)=>{var o=document.createElement("link");o.rel="stylesheet",o.type="text/css",n.nc&&(o.nonce=n.nc);var i=n=>{if(o.onerror=o.onload=null,"load"===n.type)a();else{var r=n&&n.type,i=n&&n.target&&n.target.href||e,c=new Error("Loading CSS chunk "+t+" failed.\n("+r+": "+i+")");c.name="ChunkLoadError",c.code="CSS_CHUNK_LOAD_FAILED",c.type=r,c.request=i,o.parentNode&&o.parentNode.removeChild(o),s(c)}};return o.onerror=o.onload=i,o.href=e,r?r.parentNode.insertBefore(o,r.nextSibling):document.head.appendChild(o),o},e=(t,e)=>{for(var n=document.getElementsByTagName("link"),r=0;r<n.length;r++){var a=n[r],s=a.getAttribute("data-href")||a.getAttribute("href");if("stylesheet"===a.rel&&(s===t||s===e))return a}var o=document.getElementsByTagName("style");for(r=0;r<o.length;r++){a=o[r],s=a.getAttribute("data-href");if(s===t||s===e)return a}},r=r=>new Promise((a,s)=>{var o=n.miniCssF(r),i=n.p+o;if(e(o,i))return a();t(r,i,null,a,s)}),a={524:0};n.f.miniCss=(t,e)=>{var n={9:1,48:1,128:1,264:1,278:1,289:1,313:1,330:1,458:1,476:1,512:1,552:1,561:1,677:1,685:1,706:1,766:1,849:1,858:1,870:1,928:1,986:1};a[t]?e.push(a[t]):0!==a[t]&&n[t]&&e.push(a[t]=r(t).then(()=>{a[t]=0},e=>{throw delete a[t],e}))}}})(),(()=>{var t={524:0};n.f.j=(e,r)=>{var a=n.o(t,e)?t[e]:void 0;if(0!==a)if(a)r.push(a[2]);else{var s=new Promise((n,r)=>a=t[e]=[n,r]);r.push(a[2]=s);var o=n.p+n.u(e),i=new Error,c=r=>{if(n.o(t,e)&&(a=t[e],0!==a&&(t[e]=void 0),a)){var s=r&&("load"===r.type?"missing":r.type),o=r&&r.target&&r.target.src;i.message="Loading chunk "+e+" failed.\n("+s+": "+o+")",i.name="ChunkLoadError",i.type=s,i.request=o,a[1](i)}};n.l(o,c,"chunk-"+e,e)}},n.O.j=e=>0===t[e];var e=(e,r)=>{var a,s,[o,i,c]=r,u=0;if(o.some(e=>0!==t[e])){for(a in i)n.o(i,a)&&(n.m[a]=i[a]);if(c)var l=c(n)}for(e&&e(r);u<o.length;u++)s=o[u],n.o(t,s)&&t[s]&&t[s][0](),t[s]=0;return n.O(l)},r=self["webpackChunkblog_frontend"]=self["webpackChunkblog_frontend"]||[];r.forEach(e.bind(null,0)),r.push=e.bind(null,r.push.bind(r))})();var r=n.O(void 0,[504],()=>n(73200));r=n.O(r)})();
//# sourceMappingURL=app.6f95d06c.js.map