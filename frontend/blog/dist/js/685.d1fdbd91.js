"use strict";(self["webpackChunkblog_frontend"]=self["webpackChunkblog_frontend"]||[]).push([[685],{20685:(e,t,a)=>{a.r(t),a.d(t,{default:()=>m});a(62010);var s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"article-page"},[t("div",{staticClass:"container"},[t("div",{staticClass:"filter-container"},[t("div",{staticClass:"article-header-container"},[t("h1",[e._v("文章列表")]),t("div",{staticClass:"article-tabs"},[t("el-radio-group",{attrs:{size:"medium"},on:{change:e.handleViewModeChange},model:{value:e.viewMode,callback:function(t){e.viewMode=t},expression:"viewMode"}},[t("el-radio-button",{attrs:{label:"all"}},[t("i",{staticClass:"el-icon-document"}),e._v(" 全部文章 ")]),t("el-radio-button",{attrs:{label:"self"}},[t("i",{staticClass:"el-icon-user"}),e._v(" 我的文章 ")])],1)],1)]),t("div",{staticClass:"filter-options"},[t("div",{staticClass:"category-filter"},[t("el-select",{attrs:{placeholder:"选择分类",clearable:"",size:"medium","popper-class":"category-dropdown"},on:{change:e.handleCategoryChange},model:{value:e.selectedCategoryId,callback:function(t){e.selectedCategoryId=t},expression:"selectedCategoryId"}},[t("el-option",{attrs:{label:"全部分类",value:""}}),e._l(e.categories,function(a){return t("el-option",{key:a.id,attrs:{label:a.name,value:a.id}},[t("span",{staticClass:"category-icon"},[t("i",{class:e.getCategoryIcon(a.name)})]),t("span",{staticClass:"category-name"},[e._v(e._s(a.name))])])})],2)],1),t("div",{staticClass:"article-count"},[t("el-tag",{attrs:{type:"info",effect:"plain",size:"medium"}},[t("i",{staticClass:"el-icon-collection"}),e._v(" 共 "+e._s(e.total)+" 篇文章 ")])],1)])]),e.loading?t("el-skeleton",{attrs:{loading:e.loading,animated:"",count:3}},[t("template",{slot:"template"},[t("div",{staticClass:"article-item"},[t("div",{staticClass:"article-header"},[t("el-skeleton-item",{staticStyle:{width:"50%"},attrs:{variant:"h3"}}),t("div",{staticClass:"article-meta"},[t("el-skeleton-item",{staticStyle:{width:"30%"},attrs:{variant:"text"}})],1)],1),t("div",{staticClass:"article-summary"},[t("el-skeleton-item",{staticStyle:{width:"100%"},attrs:{variant:"p"}}),t("el-skeleton-item",{staticStyle:{width:"90%"},attrs:{variant:"p"}})],1),t("div",{staticClass:"article-footer"},[t("el-skeleton-item",{staticStyle:{width:"100px"},attrs:{variant:"button"}})],1)])])],2):t("div",{staticClass:"article-list"},[t("el-row",{attrs:{gutter:30}},e._l(e.articles,function(a){return t("el-col",{key:a.id,attrs:{xs:24,sm:24,md:12,lg:12,xl:12}},[t("div",{staticClass:"article-item"},[t("div",{staticClass:"article-header"},[t("h2",{staticClass:"article-title"},[t("router-link",{attrs:{to:"/article/".concat(a.id)}},[e._v(e._s(a.title))])],1),t("div",{staticClass:"article-meta"},[t("span",[t("i",{staticClass:"el-icon-user"}),e._v(" "+e._s(a.author))]),t("span",[t("i",{staticClass:"el-icon-date"}),e._v(" "+e._s(a.date))]),t("span",[t("i",{staticClass:"el-icon-view"}),e._v(" "+e._s(a.views))]),t("span",[t("i",{staticClass:"el-icon-collection-tag"}),e._v(" "+e._s(a.categoryName))]),"self"===e.viewMode?t("span",{class:e.getStatusClass(a.status)},[t("i",{staticClass:"el-icon-info"}),e._v(" "+e._s(e.getStatusText(a.status))+" ")]):e._e()])]),a.cover?t("div",{staticClass:"article-cover"},[t("img",{attrs:{src:a.cover,alt:a.title}})]):e._e(),t("div",{staticClass:"article-summary"},[e._v(" "+e._s(a.summary)+" ")]),t("div",{staticClass:"article-footer"},[t("router-link",{attrs:{to:"/article/".concat(a.id)}},[t("el-button",{attrs:{type:"primary",size:"small"}},[e._v("阅读全文")])],1),a.tags&&a.tags.length?t("div",{staticClass:"article-tags"},e._l(a.tags,function(a,s){return t("el-tag",{key:s,attrs:{size:"small"}},[e._v(e._s(a))])}),1):e._e()],1)])])}),1),0===e.articles.length?t("el-empty",{attrs:{description:"暂无文章"}}):e._e()],1),t("div",{staticClass:"pagination"},[t("el-pagination",{attrs:{background:"",layout:"prev, pager, next","current-page":e.currentPage,"page-size":e.pageSize,total:e.total},on:{"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t},"current-change":e.handlePageChange}})],1)],1)])},r=[],i=a(54119),n=a(20908),c=a(30388),o=(a(28706),a(50113),a(64346),a(62062),a(26910),a(23288),a(18111),a(20116),a(61701),a(26099),a(68156),a(31552));const l={name:"Article",data:function(){return{articles:[],total:0,currentPage:1,pageSize:10,loading:!1,viewMode:"all",categories:[],selectedCategoryId:""}},created:function(){this.fetchCategories(),this.fetchArticles()},methods:{fetchCategories:function(){var e=this;return(0,c.A)((0,n.A)().m(function t(){var a,s;return(0,n.A)().w(function(t){while(1)switch(t.p=t.n){case 0:return t.p=0,t.n=1,o.A.category.getAll();case 1:a=t.v,200===a.code?(e.categories=a.data,console.log("获取分类列表成功:",e.categories)):(console.error("获取分类列表失败:",a.message),e.$message.error("获取分类列表失败: "+a.message)),t.n=3;break;case 2:t.p=2,s=t.v,console.error("获取分类列表失败:",s),e.$message.error("获取分类列表失败: "+(s.message||"未知错误"));case 3:return t.a(2)}},t,null,[[0,2]])}))()},fetchArticles:function(){var e=this;return(0,c.A)((0,n.A)().m(function t(){var a,s,r,c,l,u;return(0,n.A)().w(function(t){while(1)switch(t.p=t.n){case 0:if(t.p=0,e.loading=!0,console.log("开始获取文章列表..."),s={current:e.currentPage,size:e.pageSize},e.selectedCategoryId&&(s.categoryId=e.selectedCategoryId),"self"!==e.viewMode){t.n=2;break}return console.log("获取自己的文章..."),t.n=1,o.A.article.getMyList(s);case 1:a=t.v,t.n=4;break;case 2:return console.log("获取所有文章..."),t.n=3,o.A.article.getList(s);case 3:a=t.v;case 4:if(console.log("原始响应:",a),a){t.n=5;break}return console.error("响应为空"),e.$message.error("获取文章列表失败: 响应为空"),e.articles=[],t.a(2);case 5:if(r=a,console.log("文章列表响应:",r),200!==r.code){t.n=10;break}if(console.log("响应码正确"),console.log("响应数据:",r.data),c=[],l=0,!r.data||!Array.isArray(r.data)){t.n=6;break}c=r.data,l=c.length,console.log("数据是数组格式"),t.n=9;break;case 6:if(!r.data||!Array.isArray(r.data.records)){t.n=7;break}c=r.data.records,l=r.data.total||c.length,console.log("数据是分页格式"),t.n=9;break;case 7:if(!r.data||"object"!==(0,i.A)(r.data)){t.n=8;break}console.log("数据是对象格式，尝试提取"),c=[r.data],l=1,t.n=9;break;case 8:return console.error("无法识别的数据格式:",r.data),e.$message.warning("数据格式不正确"),e.articles=[],e.total=0,t.a(2);case 9:console.log("提取的记录:",c),e.articles=c.map(function(t){console.log("处理文章数据:",t);var a={id:t.id||0,title:t.title||"无标题",date:e.formatDate(t.createTime||t.create_time||new Date),views:t.viewCount||t.view_count||0,comments:t.commentCount||t.comment_count||0,summary:t.summary||"暂无摘要",author:"未知",tags:[],categoryId:t.categoryId||0,categoryName:"未分类",status:t.status||1,cover:t.cover||""};if(t.categoryId){var s=e.categories.find(function(e){return e.id===t.categoryId});s&&(a.categoryName=s.name)}return t.author&&t.author.nickname?a.author=t.author.nickname:t.user&&t.user.nickname?a.author=t.user.nickname:t.nickname?a.author=t.nickname:t.userName?a.author=t.userName:t.authorName&&(a.author=t.authorName),console.log("处理后的文章:",a),a}),"self"===e.viewMode&&e.articles.sort(function(e,t){var a={2:0,3:1,0:2,1:3},s=void 0!==a[e.status]?a[e.status]:999,r=void 0!==a[t.status]?a[t.status]:999;return s-r}),e.total=l,console.log("最终文章列表:",e.articles),0===e.articles.length&&e.$message.info("暂无文章"),t.n=11;break;case 10:console.error("响应码错误:",r.code),e.$message.error(r.message||"获取文章列表失败");case 11:t.n=13;break;case 12:t.p=12,u=t.v,console.error("获取文章列表失败:",u),e.$message.error("获取文章列表失败: "+(u.message||"未知错误"));case 13:return t.p=13,e.loading=!1,t.f(13);case 14:return t.a(2)}},t,null,[[0,12,13,14]])}))()},handlePageChange:function(e){this.currentPage=e,this.fetchArticles()},formatDate:function(e){if(!e)return"";var t=new Date(e);return"".concat(t.getFullYear(),"-").concat(String(t.getMonth()+1).padStart(2,"0"),"-").concat(String(t.getDate()).padStart(2,"0"))},handleViewModeChange:function(){this.currentPage=1,this.fetchArticles()},handleCategoryChange:function(){this.currentPage=1,this.fetchArticles()},getStatusText:function(e){switch(e){case 0:return"草稿";case 1:return"已发布";case 2:return"待审核";case 3:return"审核不通过";default:return"未知状态"}},getStatusClass:function(e){switch(e){case 0:return"status-draft";case 1:return"status-published";case 2:return"status-pending";case 3:return"status-rejected";default:return""}},getCategoryIcon:function(e){var t={技术:"el-icon-s-opportunity",生活:"el-icon-coffee-cup",资源:"el-icon-folder-opened",测试:"el-icon-s-flag",测试1:"el-icon-s-flag"};return t[e]||"el-icon-collection"}}},u=l;var d=a(81656),g=(0,d.A)(u,s,r,!1,null,"9e75e3e0",null);const m=g.exports}}]);
//# sourceMappingURL=685.d1fdbd91.js.map