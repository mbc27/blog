"use strict";(self["webpackChunkblog_frontend"]=self["webpackChunkblog_frontend"]||[]).push([[986],{23418:(t,e,i)=>{var a=i(46518),s=i(97916),o=i(84428),r=!o(function(t){Array.from(t)});a({target:"Array",stat:!0,forced:r},{from:s})},35986:(t,e,i)=>{i.r(e),i.d(e,{default:()=>p});i(52675),i(89463),i(62010);var a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"photos-page"},[e("div",{staticClass:"container"},[t._m(0),e("div",{staticClass:"photo-categories"},[t._m(1),e("el-radio-group",{model:{value:t.activeCategory,callback:function(e){t.activeCategory=e},expression:"activeCategory"}},[e("el-radio-button",{attrs:{label:"all"}},[e("i",{staticClass:"el-icon-picture"}),t._v(" 全部 ")]),t._l(t.categories,function(i){return e("el-radio-button",{key:i.id,attrs:{label:i.code}},[e("i",{class:t.getCategoryIcon(i.name)}),t._v(" "+t._s(i.name)+" ")])})],2)],1),t.loading?t._e():e("div",{staticClass:"photos-stats"},[e("div",{staticClass:"stat-item"},[e("i",{staticClass:"el-icon-picture-outline"}),e("div",{staticClass:"stat-content"},[e("div",{staticClass:"stat-value"},[t._v(t._s(t.total))]),e("div",{staticClass:"stat-label"},[t._v("总照片数")])])]),e("div",{staticClass:"stat-item"},[e("i",{staticClass:"el-icon-collection"}),e("div",{staticClass:"stat-content"},[e("div",{staticClass:"stat-value"},[t._v(t._s(t.categories.length))]),e("div",{staticClass:"stat-label"},[t._v("分类数")])])]),e("div",{staticClass:"stat-item"},[e("i",{staticClass:"el-icon-view"}),e("div",{staticClass:"stat-content"},[e("div",{staticClass:"stat-value"},[t._v(t._s(t.totalViews))]),e("div",{staticClass:"stat-label"},[t._v("总浏览量")])])])]),t.loading?e("el-skeleton",{attrs:{loading:t.loading,animated:"",count:6}},[e("template",{slot:"template"},[e("div",{staticClass:"photo-grid"},t._l(6,function(t){return e("div",{key:t,staticClass:"photo-item"},[e("div",{staticClass:"photo-card"},[e("div",{staticClass:"photo-image"},[e("el-skeleton-item",{staticStyle:{width:"100%",height:"200px"},attrs:{variant:"image"}})],1),e("div",{staticClass:"photo-info"},[e("el-skeleton-item",{staticStyle:{width:"50%"},attrs:{variant:"h3"}}),e("el-skeleton-item",{staticStyle:{width:"100%"},attrs:{variant:"text"}}),e("el-skeleton-item",{staticStyle:{width:"100%"},attrs:{variant:"text"}})],1)])])}),0)])],2):[e("transition-group",{staticClass:"photo-grid",attrs:{name:"photo-fade",tag:"div"}},t._l(t.filteredPhotos,function(i){return e("div",{key:i.id,staticClass:"photo-item"},[e("div",{staticClass:"photo-card",on:{click:function(e){return t.previewImage(i)}}},[e("div",{staticClass:"photo-image"},[e("img",{attrs:{src:i.url,alt:i.title}}),e("div",{staticClass:"photo-overlay"},[e("i",{staticClass:"el-icon-zoom-in"})])]),e("div",{staticClass:"photo-info"},[e("h3",[t._v(t._s(i.title))]),e("p",[t._v(t._s(i.description))]),e("div",{staticClass:"photo-meta"},[e("span",{staticClass:"photo-date"},[e("i",{staticClass:"el-icon-date"}),t._v(" "+t._s(i.date))]),e("span",{staticClass:"photo-views"},[e("i",{staticClass:"el-icon-view"}),t._v(" "+t._s(i.views))])]),t.getCategoryName(i.category)?e("div",{staticClass:"photo-category"},[e("el-tag",{attrs:{size:"small",type:t.getCategoryType(i.category)}},[e("i",{class:t.getCategoryIcon(t.getCategoryName(i.category))}),t._v(" "+t._s(t.getCategoryName(i.category))+" ")])],1):t._e()])])])}),0),0===t.filteredPhotos.length?e("el-empty",{attrs:{description:"暂无图片","image-size":200}},[e("template",{slot:"description"},[e("p",{staticClass:"empty-text"},[t._v("当前分类下暂无图片")])]),e("el-button",{attrs:{type:"primary"},on:{click:function(e){t.activeCategory="all"}}},[t._v("查看全部图片")])],2):t._e()],e("div",{staticClass:"pagination"},[e("el-pagination",{attrs:{background:"",layout:"total, prev, pager, next, jumper","current-page":t.currentPage,"page-size":t.pageSize,total:t.total},on:{"update:currentPage":function(e){t.currentPage=e},"update:current-page":function(e){t.currentPage=e},"current-change":t.handlePageChange}})],1),e("el-dialog",{attrs:{visible:t.previewVisible,width:"80%",center:"","custom-class":"photo-preview-dialog","show-close":!0},on:{"update:visible":function(e){t.previewVisible=e},close:t.closePreview}},[e("div",{staticClass:"photo-preview-container"},[e("div",{staticClass:"preview-image"},[e("img",{attrs:{src:t.previewPhoto.url,alt:t.previewPhoto.title}})]),e("div",{staticClass:"preview-info"},[e("h2",[t._v(t._s(t.previewPhoto.title))]),e("p",{staticClass:"preview-description"},[t._v(t._s(t.previewPhoto.description))]),e("div",{staticClass:"preview-meta"},[e("div",{staticClass:"meta-item"},[e("i",{staticClass:"el-icon-date"}),e("span",[t._v("上传日期: "+t._s(t.previewPhoto.date))])]),e("div",{staticClass:"meta-item"},[e("i",{staticClass:"el-icon-view"}),e("span",[t._v("浏览次数: "+t._s(t.previewPhoto.views))])]),t.getCategoryName(t.previewPhoto.category)?e("div",{staticClass:"meta-item"},[e("i",{staticClass:"el-icon-collection-tag"}),e("span",[t._v("所属分类: "+t._s(t.getCategoryName(t.previewPhoto.category)))])]):t._e()])])]),t.filteredPhotos.length>1?e("div",{staticClass:"preview-navigation"},[e("el-button",{attrs:{type:"text",disabled:t.previewIndex<=0},on:{click:t.prevImage}},[e("i",{staticClass:"el-icon-arrow-left"}),t._v(" 上一张 ")]),e("span",{staticClass:"preview-counter"},[t._v(t._s(t.previewIndex+1)+" / "+t._s(t.filteredPhotos.length))]),e("el-button",{attrs:{type:"text",disabled:t.previewIndex>=t.filteredPhotos.length-1},on:{click:t.nextImage}},[t._v(" 下一张 "),e("i",{staticClass:"el-icon-arrow-right"})])],1):t._e()])],2)])},s=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"page-header"},[e("h1",[t._v("我的相册")]),e("div",{staticClass:"header-decoration"})])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"category-title"},[e("i",{staticClass:"el-icon-collection-tag"}),e("span",[t._v("分类浏览")])])}],o=i(20908),r=i(30388),n=(i(76918),i(28706),i(2008),i(50113),i(48980),i(23418),i(64346),i(62062),i(72712),i(23288),i(18111),i(22489),i(20116),i(61701),i(18237),i(26099),i(58940),i(38781),i(47764),i(68156),i(11392),i(31552));const c={name:"Photos",data:function(){return{activeCategory:"all",photos:[],categories:[],loading:!1,currentPage:1,pageSize:12,total:0,previewVisible:!1,previewPhoto:{},previewIndex:0}},created:function(){this.fetchCategories(),this.fetchPhotos()},computed:{filteredPhotos:function(){var t=this;return"all"===this.activeCategory?this.photos:this.photos.filter(function(e){return e.category===t.activeCategory})},totalViews:function(){return this.photos.reduce(function(t,e){return t+(e.views||0)},0)}},methods:{getCategoryIcon:function(t){if(!t)return"el-icon-picture";var e={风景:"el-icon-picture-outline",人物:"el-icon-user",动物:"el-icon-cherry",植物:"el-icon-sugar",建筑:"el-icon-office-building",美食:"el-icon-food",旅行:"el-icon-place",生活:"el-icon-coffee-cup",艺术:"el-icon-brush",科技:"el-icon-cpu",其他:"el-icon-more",ceshi:"el-icon-s-flag"};return e[t]||"el-icon-picture"},getCategoryName:function(t){if("all"===t)return"全部";var e=this.categories.find(function(e){return e.code===t});return e?e.name:""},getCategoryType:function(t){if("all"===t)return"";var e=["","success","warning","danger","info"],i=parseInt(t)%e.length;return e[i]},previewImage:function(t){this.previewPhoto=t,this.previewIndex=this.filteredPhotos.findIndex(function(e){return e.id===t.id}),this.previewVisible=!0},closePreview:function(){this.previewVisible=!1},prevImage:function(){this.previewIndex>0&&(this.previewIndex--,this.previewPhoto=this.filteredPhotos[this.previewIndex])},nextImage:function(){this.previewIndex<this.filteredPhotos.length-1&&(this.previewIndex++,this.previewPhoto=this.filteredPhotos[this.previewIndex])},getFullImageUrl:function(t){return t?t.startsWith("http")?t:t.startsWith("/")?"http://localhost:8080".concat(t):"http://localhost:8080/uploads/".concat(t):""},fetchCategories:function(){var t=this;return(0,r.A)((0,o.A)().m(function e(){var i,a,s;return(0,o.A)().w(function(e){while(1)switch(e.p=e.n){case 0:return e.p=0,e.n=1,n.A.photo.getCategories();case 1:i=e.v,200===i.code&&(a=i.data||[],t.categories=a.map(function(t){return{id:t.id,name:t.categoryName||t.name,code:t.id.toString()}})),e.n=3;break;case 2:e.p=2,s=e.v,console.error("获取相册分类失败:",s),t.categories=[];case 3:return e.a(2)}},e,null,[[0,2]])}))()},fetchPhotos:function(){var t=this;return(0,r.A)((0,o.A)().m(function e(){var i,a,s;return(0,o.A)().w(function(e){while(1)switch(e.p=e.n){case 0:return e.p=0,t.loading=!0,i={current:t.currentPage,size:t.pageSize},"all"!==t.activeCategory&&(i.categoryId=t.activeCategory),e.n=1,n.A.photo.getList(i);case 1:a=e.v,200===a.code&&(a.data&&Array.isArray(a.data.records)?(t.photos=a.data.records.map(function(e){return{id:e.id,url:t.getFullImageUrl(e.url)||"https://via.placeholder.com/400x300",title:e.description||e.title||"无标题",description:e.description||"暂无描述",date:t.formatDate(e.createTime),views:e.views||0,category:e.categoryId?e.categoryId.toString():"all"}}),t.total=a.data.total||0):(t.photos=[],t.total=0,console.warn("相册数据格式不正确:",a.data))),e.n=3;break;case 2:e.p=2,s=e.v,console.error("获取相册列表失败:",s),t.photos=[],t.total=0,t.photos=Array.from({length:4},function(t,e){return{id:e+1,url:"https://placehold.co/400x300/e9ecef/495057?text=示例图片 ".concat(e+1),title:"示例标题 ".concat(e+1),description:"这是一个示例图片描述，当API不可用时显示。",date:"2025-08-27",views:0,category:"all"}});case 3:return e.p=3,t.loading=!1,e.f(3);case 4:return e.a(2)}},e,null,[[0,2,3,4]])}))()},handlePageChange:function(t){this.currentPage=t,this.fetchPhotos()},handleCategoryChange:function(){this.currentPage=1,this.fetchPhotos()},formatDate:function(t){if(!t)return"";var e=new Date(t);return"".concat(e.getFullYear(),"-").concat(String(e.getMonth()+1).padStart(2,"0"),"-").concat(String(e.getDate()).padStart(2,"0"))}},watch:{activeCategory:function(){this.handleCategoryChange()}}},l=c;var d=i(81656),v=(0,d.A)(l,a,s,!1,null,"15534329",null);const p=v.exports}}]);
//# sourceMappingURL=986.614029b5.js.map