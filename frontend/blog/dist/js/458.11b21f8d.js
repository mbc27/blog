"use strict";(self["webpackChunkblog_frontend"]=self["webpackChunkblog_frontend"]||[]).push([[458],{11458:(e,r,a)=>{a.r(r),a.d(r,{default:()=>d});var s=function(){var e=this,r=e._self._c;return r("div",{staticClass:"user-profile-container"},[r("el-card",{staticClass:"profile-card"},[r("div",{staticClass:"header",attrs:{slot:"header"},slot:"header"},[r("span",[e._v("个人信息")])]),r("el-form",{ref:"userForm",attrs:{model:e.userForm,rules:e.rules,"label-width":"80px"}},[r("el-form-item",{attrs:{label:"用户名"}},[r("el-input",{attrs:{disabled:""},model:{value:e.userForm.username,callback:function(r){e.$set(e.userForm,"username",r)},expression:"userForm.username"}})],1),r("el-form-item",{attrs:{label:"昵称",prop:"nickname"}},[r("el-input",{model:{value:e.userForm.nickname,callback:function(r){e.$set(e.userForm,"nickname",r)},expression:"userForm.nickname"}})],1),r("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[r("el-input",{model:{value:e.userForm.email,callback:function(r){e.$set(e.userForm,"email",r)},expression:"userForm.email"}})],1),r("el-form-item",{attrs:{label:"手机号",prop:"phone"}},[r("el-input",{model:{value:e.userForm.phone,callback:function(r){e.$set(e.userForm,"phone",r)},expression:"userForm.phone"}})],1),r("el-form-item",{attrs:{label:"头像"}},[r("el-upload",{staticClass:"avatar-uploader",attrs:{action:"/api/upload","show-file-list":!1,"on-success":e.handleAvatarSuccess,"before-upload":e.beforeAvatarUpload}},[e.userForm.avatar?r("img",{staticClass:"avatar",attrs:{src:e.userForm.avatar}}):r("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),r("el-form-item",[r("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:e.updateProfile}},[e._v("保存修改")])],1)],1)],1)],1)},t=[],n=a(20908),o=a(30388),i=a(41034),l=a(93518);const u={name:"UserProfile",data:function(){return{loading:!1,userForm:{id:"",username:"",nickname:"",email:"",phone:"",avatar:""},rules:{nickname:[{required:!0,message:"请输入昵称",trigger:"blur"},{min:2,max:20,message:"长度在 2 到 20 个字符",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{type:"email",message:"请输入正确的邮箱地址",trigger:"blur"}],phone:[{pattern:/^1[3-9]\d{9}$/,message:"请输入正确的手机号码",trigger:"blur"}]}}},computed:(0,i.A)({},(0,l.L8)(["user"])),created:function(){this.getUserInfo()},methods:(0,i.A)((0,i.A)({},(0,l.i0)(["updateUserInfo"])),{},{getUserInfo:function(){var e=this;return(0,o.A)((0,n.A)().m(function r(){var a;return(0,n.A)().w(function(r){while(1)switch(r.p=r.n){case 0:if(r.p=0,!e.user){r.n=1;break}e.userForm=(0,i.A)({},e.user),r.n=3;break;case 1:return r.n=2,e.$axios.get("/api/user/info");case 2:a=r.v,200===a.data.code&&(e.userForm=a.data.data);case 3:r.n=5;break;case 4:r.p=4,r.v,e.$message.error("获取用户信息失败");case 5:return r.a(2)}},r,null,[[0,4]])}))()},updateProfile:function(){var e=this;this.$refs.userForm.validate(function(){var r=(0,o.A)((0,n.A)().m(function r(a){var s;return(0,n.A)().w(function(r){while(1)switch(r.p=r.n){case 0:if(!a){r.n=5;break}return e.loading=!0,r.p=1,r.n=2,e.updateUserInfo(e.userForm);case 2:e.$message.success("个人信息更新成功"),r.n=4;break;case 3:r.p=3,s=r.v,e.$message.error(s.message||"更新失败");case 4:return r.p=4,e.loading=!1,r.f(4);case 5:return r.a(2)}},r,null,[[1,3,4,5]])}));return function(e){return r.apply(this,arguments)}}())},handleAvatarSuccess:function(e){200===e.code?this.userForm.avatar=e.data:this.$message.error("上传失败")},beforeAvatarUpload:function(e){var r="image/jpeg"===e.type||"image/png"===e.type,a=e.size/1024/1024<2;return r||this.$message.error("上传头像图片只能是 JPG 或 PNG 格式!"),a||this.$message.error("上传头像图片大小不能超过 2MB!"),r&&a}})},m=u;var c=a(81656),p=(0,c.A)(m,s,t,!1,null,"f84f1008",null);const d=p.exports}}]);
//# sourceMappingURL=458.11b21f8d.js.map