"use strict";(self["webpackChunkblog_frontend"]=self["webpackChunkblog_frontend"]||[]).push([[289],{46289:(e,t,r)=>{r.r(t),r.d(t,{default:()=>p});r(52675),r(89463),r(25276),r(62010);var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"friend-link-management"},[t("el-card",{attrs:{shadow:"hover"}},[t("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[t("span",[e._v("友链管理")]),t("el-button",{staticStyle:{float:"right",padding:"3px 0"},attrs:{type:"text"},on:{click:e.refreshFriendLinks}},[e._v(" 刷新 ")])],1),t("div",{staticClass:"search-bar"},[t("el-input",{staticStyle:{width:"300px","margin-right":"10px"},attrs:{placeholder:"搜索友链名称、描述或网址",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchFriendLinks.apply(null,arguments)}},model:{value:e.searchKeyword,callback:function(t){e.searchKeyword=t},expression:"searchKeyword"}},[t("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.searchFriendLinks},slot:"append"})],1),t("el-button",{attrs:{type:"primary"},on:{click:e.showAddDialog}},[e._v(" 新增友链 ")]),t("el-button",{attrs:{type:"danger",disabled:0===e.selectedFriendLinks.length},on:{click:e.batchDeleteFriendLinks}},[e._v(" 批量删除 ("+e._s(e.selectedFriendLinks.length)+") ")])],1),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%","margin-top":"20px"},attrs:{data:e.friendLinks},on:{"selection-change":e.handleSelectionChange}},[t("el-table-column",{attrs:{type:"selection",width:"55"}}),t("el-table-column",{attrs:{prop:"id",label:"ID",width:"80"}}),t("el-table-column",{attrs:{prop:"name",label:"友链名称",width:"150"},scopedSlots:e._u([{key:"default",fn:function(r){return[t("el-tag",{attrs:{size:"small"}},[e._v(e._s(r.row.name))])]}}])}),t("el-table-column",{attrs:{prop:"description",label:"描述",width:"200","show-overflow-tooltip":""}}),t("el-table-column",{attrs:{prop:"url",label:"网址",width:"200","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(r){return[t("el-link",{attrs:{href:r.row.url,target:"_blank",type:"primary"}},[e._v(e._s(r.row.url))])]}}])}),t("el-table-column",{attrs:{prop:"avatar",label:"头像",width:"100"},scopedSlots:e._u([{key:"default",fn:function(r){return[r.row.avatar?t("el-image",{staticStyle:{width:"40px",height:"40px","border-radius":"50%"},attrs:{src:r.row.avatar,fit:"cover"}}):t("span",[e._v("无头像")])]}}])}),t("el-table-column",{attrs:{prop:"status",label:"状态",width:"100"},scopedSlots:e._u([{key:"default",fn:function(r){return[t("el-tag",{attrs:{type:1===r.row.status?"success":2===r.row.status?"danger":"warning",size:"small"}},[e._v(" "+e._s(e.getStatusText(r.row.status))+" ")])]}}])}),t("el-table-column",{attrs:{prop:"sortOrder",label:"排序",width:"80"}}),t("el-table-column",{attrs:{prop:"createTime",label:"创建时间",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.formatDate(t.row.createTime))+" ")]}}])}),t("el-table-column",{attrs:{label:"操作",width:"250"},scopedSlots:e._u([{key:"default",fn:function(r){return[t("el-button-group",[t("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.viewFriendLink(r.row)}}},[e._v("查看")]),t("el-button",{attrs:{size:"mini",type:"warning"},on:{click:function(t){return e.editFriendLink(r.row)}}},[e._v("编辑")]),1!==r.row.status?t("el-button",{attrs:{size:"mini",type:"success"},on:{click:function(t){return e.auditFriendLink(r.row.id,1)}}},[e._v(" 通过 ")]):e._e(),2!==r.row.status?t("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(t){return e.auditFriendLink(r.row.id,2)}}},[e._v(" 拒绝 ")]):e._e(),t("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(t){return e.deleteFriendLink(r.row.id)}}},[e._v("删除")])],1)]}}])})],1),t("div",{staticClass:"pagination-container"},[t("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[10,20,30,50],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1),t("el-dialog",{attrs:{title:"友链详情",visible:e.viewDialogVisible,width:"50%"},on:{"update:visible":function(t){e.viewDialogVisible=t}}},[e.currentFriendLink?t("div",[t("el-descriptions",{attrs:{column:2,border:""}},[t("el-descriptions-item",{attrs:{label:"ID"}},[e._v(e._s(e.currentFriendLink.id))]),t("el-descriptions-item",{attrs:{label:"名称"}},[e._v(e._s(e.currentFriendLink.name))]),t("el-descriptions-item",{attrs:{label:"描述",span:2}},[e._v(e._s(e.currentFriendLink.description))]),t("el-descriptions-item",{attrs:{label:"网址",span:2}},[t("el-link",{attrs:{href:e.currentFriendLink.url,target:"_blank",type:"primary"}},[e._v(e._s(e.currentFriendLink.url))])],1),t("el-descriptions-item",{attrs:{label:"头像",span:2}},[e.currentFriendLink.avatar?t("el-image",{staticStyle:{width:"60px",height:"60px","border-radius":"50%"},attrs:{src:e.currentFriendLink.avatar,fit:"cover"}}):t("span",[e._v("无头像")])],1),t("el-descriptions-item",{attrs:{label:"状态"}},[t("el-tag",{attrs:{type:1===e.currentFriendLink.status?"success":2===e.currentFriendLink.status?"danger":"warning",size:"small"}},[e._v(" "+e._s(e.getStatusText(e.currentFriendLink.status))+" ")])],1),t("el-descriptions-item",{attrs:{label:"排序"}},[e._v(e._s(e.currentFriendLink.sortOrder))]),t("el-descriptions-item",{attrs:{label:"创建时间"}},[e._v(e._s(e.formatDate(e.currentFriendLink.createTime)))]),t("el-descriptions-item",{attrs:{label:"更新时间"}},[e._v(e._s(e.formatDate(e.currentFriendLink.updateTime)))])],1)],1):e._e()]),t("el-dialog",{attrs:{title:e.editForm.id?"编辑友链":"新增友链",visible:e.editDialogVisible,width:"50%"},on:{"update:visible":function(t){e.editDialogVisible=t}}},[t("el-form",{ref:"editForm",attrs:{model:e.editForm,rules:e.editRules,"label-width":"100px"}},[t("el-form-item",{attrs:{label:"友链名称",prop:"name"}},[t("el-input",{attrs:{placeholder:"请输入友链名称"},model:{value:e.editForm.name,callback:function(t){e.$set(e.editForm,"name",t)},expression:"editForm.name"}})],1),t("el-form-item",{attrs:{label:"友链描述",prop:"description"}},[t("el-input",{attrs:{type:"textarea",placeholder:"请输入友链描述"},model:{value:e.editForm.description,callback:function(t){e.$set(e.editForm,"description",t)},expression:"editForm.description"}})],1),t("el-form-item",{attrs:{label:"友链网址",prop:"url"}},[t("el-input",{attrs:{placeholder:"请输入友链网址"},model:{value:e.editForm.url,callback:function(t){e.$set(e.editForm,"url",t)},expression:"editForm.url"}})],1),t("el-form-item",{attrs:{label:"友链头像",prop:"avatar"}},[t("el-input",{attrs:{placeholder:"请输入友链头像地址"},model:{value:e.editForm.avatar,callback:function(t){e.$set(e.editForm,"avatar",t)},expression:"editForm.avatar"}})],1),t("el-form-item",{attrs:{label:"状态",prop:"status"}},[t("el-select",{attrs:{placeholder:"请选择状态"},model:{value:e.editForm.status,callback:function(t){e.$set(e.editForm,"status",t)},expression:"editForm.status"}},[t("el-option",{attrs:{label:"待审核",value:0}}),t("el-option",{attrs:{label:"已通过",value:1}}),t("el-option",{attrs:{label:"已拒绝",value:2}})],1)],1),t("el-form-item",{attrs:{label:"排序",prop:"sortOrder"}},[t("el-input-number",{attrs:{min:0,placeholder:"排序值"},model:{value:e.editForm.sortOrder,callback:function(t){e.$set(e.editForm,"sortOrder",t)},expression:"editForm.sortOrder"}})],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.editDialogVisible=!1}}},[e._v("取消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.saveFriendLink}},[e._v("确定")])],1)],1)],1)},i=[],a=r(20908),s=r(30388),l=(r(62062),r(23288),r(18111),r(61701),r(26099),r(31552));const o={name:"FriendLinkManagement",data:function(){return{friendLinks:[],loading:!1,searchKeyword:"",selectedFriendLinks:[],currentPage:1,pageSize:10,total:0,viewDialogVisible:!1,editDialogVisible:!1,currentFriendLink:null,editForm:{id:null,name:"",description:"",url:"",avatar:"",status:0,sortOrder:0},editRules:{name:[{required:!0,message:"请输入友链名称",trigger:"blur"}],url:[{required:!0,message:"请输入友链网址",trigger:"blur"},{type:"url",message:"请输入正确的网址格式",trigger:"blur"}],status:[{required:!0,message:"请选择状态",trigger:"change"}]}}},mounted:function(){this.fetchFriendLinks()},methods:{fetchFriendLinks:function(){var e=this;return(0,s.A)((0,a.A)().m(function t(){var r,n;return(0,a.A)().w(function(t){while(1)switch(t.p=t.n){case 0:return e.loading=!0,t.p=1,t.n=2,l.A.friendLink.getAdminList({current:e.currentPage,size:e.pageSize,keyword:e.searchKeyword});case 2:r=t.v,console.log("友链列表响应:",r),200===r.code?(e.friendLinks=r.data.records,e.total=r.data.total):e.$message.error(r.message||"获取友链列表失败"),t.n=4;break;case 3:t.p=3,n=t.v,e.$message.error("获取友链列表失败"),console.error("Error fetching friend links:",n);case 4:return t.p=4,e.loading=!1,t.f(4);case 5:return t.a(2)}},t,null,[[1,3,4,5]])}))()},refreshFriendLinks:function(){this.currentPage=1,this.searchKeyword="",this.fetchFriendLinks()},searchFriendLinks:function(){var e=this;return(0,s.A)((0,a.A)().m(function t(){return(0,a.A)().w(function(t){while(1)switch(t.n){case 0:e.currentPage=1,e.fetchFriendLinks();case 1:return t.a(2)}},t)}))()},handleSelectionChange:function(e){this.selectedFriendLinks=e},handleSizeChange:function(e){this.pageSize=e,this.currentPage=1,this.fetchFriendLinks()},handleCurrentChange:function(e){this.currentPage=e,this.fetchFriendLinks()},viewFriendLink:function(e){this.currentFriendLink=e,this.viewDialogVisible=!0},showAddDialog:function(){this.editForm={id:null,name:"",description:"",url:"",avatar:"",status:0,sortOrder:0},this.editDialogVisible=!0},editFriendLink:function(e){this.editForm={id:e.id,name:e.name,description:e.description,url:e.url,avatar:e.avatar,status:e.status,sortOrder:e.sortOrder},this.editDialogVisible=!0},saveFriendLink:function(){var e=this;return(0,s.A)((0,a.A)().m(function t(){return(0,a.A)().w(function(t){while(1)switch(t.n){case 0:e.$refs.editForm.validate(function(){var t=(0,s.A)((0,a.A)().m(function t(r){var n,i;return(0,a.A)().w(function(t){while(1)switch(t.p=t.n){case 0:if(!r){t.n=7;break}if(t.p=1,!e.editForm.id){t.n=3;break}return t.n=2,l.A.friendLink.update(e.editForm);case 2:n=t.v,t.n=5;break;case 3:return t.n=4,l.A.friendLink.add(e.editForm);case 4:n=t.v;case 5:200===n.code?(e.$message.success(e.editForm.id?"更新成功":"新增成功"),e.editDialogVisible=!1,e.fetchFriendLinks()):e.$message.error(n.message||"操作失败"),t.n=7;break;case 6:t.p=6,i=t.v,e.$message.error("操作失败"),console.error("Error saving friend link:",i);case 7:return t.a(2)}},t,null,[[1,6]])}));return function(e){return t.apply(this,arguments)}}());case 1:return t.a(2)}},t)}))()},auditFriendLink:function(e,t){var r=this;return(0,s.A)((0,a.A)().m(function n(){var i,s;return(0,a.A)().w(function(n){while(1)switch(n.p=n.n){case 0:return n.p=0,n.n=1,l.A.friendLink.audit(e,t);case 1:i=n.v,200===i.code?(r.$message.success(i.message),r.fetchFriendLinks()):r.$message.error(i.message||"审核失败"),n.n=3;break;case 2:n.p=2,s=n.v,r.$message.error("审核失败"),console.error("Error auditing friend link:",s);case 3:return n.a(2)}},n,null,[[0,2]])}))()},deleteFriendLink:function(e){var t=this;this.$confirm("此操作将永久删除该友链, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((0,s.A)((0,a.A)().m(function r(){var n,i;return(0,a.A)().w(function(r){while(1)switch(r.p=r.n){case 0:return r.p=0,r.n=1,l.A.friendLink["delete"](e);case 1:n=r.v,200===n.code?(t.$message.success("删除成功"),t.fetchFriendLinks()):t.$message.error(n.message||"删除失败"),r.n=3;break;case 2:r.p=2,i=r.v,t.$message.error("删除失败"),console.error("Error deleting friend link:",i);case 3:return r.a(2)}},r,null,[[0,2]])})))},batchDeleteFriendLinks:function(){var e=this;0!==this.selectedFriendLinks.length?this.$confirm("此操作将永久删除选中的 ".concat(this.selectedFriendLinks.length," 个友链, 是否继续?"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((0,s.A)((0,a.A)().m(function t(){var r,n,i;return(0,a.A)().w(function(t){while(1)switch(t.p=t.n){case 0:return t.p=0,r=e.selectedFriendLinks.map(function(e){return e.id}),t.n=1,l.A.friendLink.batchDelete(r);case 1:n=t.v,200===n.code?(e.$message.success("批量删除成功"),e.fetchFriendLinks()):e.$message.error(n.message||"批量删除失败"),t.n=3;break;case 2:t.p=2,i=t.v,e.$message.error("批量删除失败"),console.error("Error batch deleting friend links:",i);case 3:return t.a(2)}},t,null,[[0,2]])}))):this.$message.warning("请选择要删除的友链")},getStatusText:function(e){var t={0:"待审核",1:"已通过",2:"已拒绝"};return t[e]||"未知"},formatDate:function(e){if(!e)return"";var t=new Date(e);return t.toLocaleString("zh-CN")}}},c=o;var d=r(81656),u=(0,d.A)(c,n,i,!1,null,"0bd98c0a",null);const p=u.exports}}]);
//# sourceMappingURL=289.665b4609.js.map