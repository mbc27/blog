"use strict";(self["webpackChunkblog_frontend"]=self["webpackChunkblog_frontend"]||[]).push([[476],{61476:(e,t,a)=>{a.r(t),a.d(t,{default:()=>d});a(25276);var r=function(){var e=this,t=e._self._c;return t("div",{staticClass:"user-management"},[t("div",{staticClass:"search-form"},[t("el-form",{staticClass:"search-form-inline",attrs:{model:e.searchForm,inline:""}},[t("el-form-item",{attrs:{label:"用户名"}},[t("el-input",{staticStyle:{width:"180px"},attrs:{placeholder:"请输入用户名",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchUsers.apply(null,arguments)}},model:{value:e.searchForm.username,callback:function(t){e.$set(e.searchForm,"username",t)},expression:"searchForm.username"}})],1),t("el-form-item",{attrs:{label:"昵称"}},[t("el-input",{staticStyle:{width:"180px"},attrs:{placeholder:"请输入昵称",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchUsers.apply(null,arguments)}},model:{value:e.searchForm.nickname,callback:function(t){e.$set(e.searchForm,"nickname",t)},expression:"searchForm.nickname"}})],1),t("el-form-item",{attrs:{label:"角色"}},[t("el-select",{staticStyle:{width:"120px"},attrs:{placeholder:"请选择角色",clearable:""},on:{change:e.searchUsers},model:{value:e.searchForm.role,callback:function(t){e.$set(e.searchForm,"role",t)},expression:"searchForm.role"}},[t("el-option",{attrs:{label:"管理员",value:0}}),t("el-option",{attrs:{label:"普通用户",value:1}})],1)],1),t("el-form-item",{attrs:{label:"状态"}},[t("el-select",{staticStyle:{width:"120px"},attrs:{placeholder:"请选择状态",clearable:""},on:{change:e.searchUsers},model:{value:e.searchForm.status,callback:function(t){e.$set(e.searchForm,"status",t)},expression:"searchForm.status"}},[t("el-option",{attrs:{label:"正常",value:1}}),t("el-option",{attrs:{label:"禁用",value:0}})],1)],1),t("el-form-item",[t("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.searchUsers}},[e._v("搜索")]),t("el-button",{attrs:{icon:"el-icon-refresh"},on:{click:e.resetSearch}},[e._v("重置")]),t("el-button",{attrs:{type:"success",icon:"el-icon-download"},on:{click:e.exportUsers}},[e._v("导出")])],1)],1)],1),t("div",{staticClass:"table-container"},[t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.userList,"current-page":e.currentPage,"page-size":e.pageSize}},[t("el-table-column",{attrs:{label:"序号",width:"80",formatter:function(t,a,r,s){return(e.currentPage-1)*e.pageSize+s+1}}}),t("el-table-column",{attrs:{prop:"username",label:"用户名",width:"120"}}),t("el-table-column",{attrs:{prop:"nickname",label:"昵称",width:"120"}}),t("el-table-column",{attrs:{prop:"email",label:"邮箱",width:"180"}}),t("el-table-column",{attrs:{label:"角色",width:"100"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-tag",{attrs:{type:0===a.row.role?"danger":"primary"}},[e._v(" "+e._s(0===a.row.role?"管理员":"普通用户")+" ")])]}}])}),t("el-table-column",{attrs:{label:"状态",width:"100"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-tag",{attrs:{type:1===a.row.status?"success":"danger"}},[e._v(" "+e._s(1===a.row.status?"正常":"禁用")+" ")])]}}])}),t("el-table-column",{attrs:{prop:"createTime",label:"创建时间",width:"180"}}),t("el-table-column",{attrs:{label:"操作",width:"300"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{size:"mini"},on:{click:function(t){return e.editUser(a.row)}}},[e._v("编辑")]),t("el-button",{attrs:{size:"mini",type:1===a.row.status?"warning":"success"},on:{click:function(t){return e.toggleUserStatus(a.row)}}},[e._v(" "+e._s(1===a.row.status?"禁用":"启用")+" ")]),t("el-button",{attrs:{size:"mini",type:"info"},on:{click:function(t){return e.resetPassword(a.row)}}},[e._v("重置密码")]),t("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(t){return e.deleteUser(a.row)}}},[e._v("删除")])]}}])})],1),t("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[10,20,50,100],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),t("el-dialog",{attrs:{title:"编辑用户",visible:e.editDialogVisible,width:"500px"},on:{"update:visible":function(t){e.editDialogVisible=t}}},[t("el-form",{attrs:{model:e.editForm,"label-width":"80px"}},[t("el-form-item",{attrs:{label:"用户名"}},[t("el-input",{attrs:{disabled:""},model:{value:e.editForm.username,callback:function(t){e.$set(e.editForm,"username",t)},expression:"editForm.username"}})],1),t("el-form-item",{attrs:{label:"昵称"}},[t("el-input",{model:{value:e.editForm.nickname,callback:function(t){e.$set(e.editForm,"nickname",t)},expression:"editForm.nickname"}})],1),t("el-form-item",{attrs:{label:"邮箱"}},[t("el-input",{model:{value:e.editForm.email,callback:function(t){e.$set(e.editForm,"email",t)},expression:"editForm.email"}})],1),t("el-form-item",{attrs:{label:"角色"}},[t("el-select",{staticStyle:{width:"100%"},model:{value:e.editForm.role,callback:function(t){e.$set(e.editForm,"role",t)},expression:"editForm.role"}},[t("el-option",{attrs:{label:"管理员",value:0}}),t("el-option",{attrs:{label:"普通用户",value:1}})],1)],1),t("el-form-item",{attrs:{label:"状态"}},[t("el-select",{staticStyle:{width:"100%"},model:{value:e.editForm.status,callback:function(t){e.$set(e.editForm,"status",t)},expression:"editForm.status"}},[t("el-option",{attrs:{label:"正常",value:1}}),t("el-option",{attrs:{label:"禁用",value:0}})],1)],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.editDialogVisible=!1}}},[e._v("取消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.saveUser}},[e._v("保存")])],1)],1)],1)},s=[],n=a(20908),l=a(30388),o=(a(28706),a(51629),a(18111),a(7588),a(79432),a(26099),a(23500),a(31552));const i={name:"UserManagement",data:function(){return{loading:!1,userList:[],searchForm:{username:"",nickname:"",role:null,status:null},currentPage:1,pageSize:10,total:0,editDialogVisible:!1,editForm:{id:null,username:"",nickname:"",email:"",role:1,status:1}}},created:function(){this.loadUsers()},methods:{loadUsers:function(){var e=this;return(0,l.A)((0,n.A)().m(function t(){var a,r,s;return(0,n.A)().w(function(t){while(1)switch(t.p=t.n){case 0:return t.p=0,e.loading=!0,a={page:e.currentPage,size:e.pageSize},Object.keys(e.searchForm).forEach(function(t){var r=e.searchForm[t];null!==r&&void 0!==r&&""!==r&&(a[t]=r)}),console.log("搜索参数:",a),t.n=1,o.A.adminUser.getList(a);case 1:r=t.v,console.log("用户列表响应:",r),200===r.code?(e.userList=r.data.records||[],e.total=r.data.total||0,0===e.userList.length&&0===e.total&&e.$message.info("未找到符合条件的用户")):e.$message.error("获取用户列表失败: "+(r.message||"未知错误")),t.n=3;break;case 2:t.p=2,s=t.v,console.error("获取用户列表失败:",s),e.$message.error("获取用户列表失败: "+(s.message||"网络错误"));case 3:return t.p=3,e.loading=!1,t.f(3);case 4:return t.a(2)}},t,null,[[0,2,3,4]])}))()},searchUsers:function(){this.currentPage=1,this.loadUsers()},resetSearch:function(){this.searchForm={username:"",nickname:"",role:null,status:null},this.currentPage=1,this.loadUsers()},exportUsers:function(){this.$message.info("导出功能开发中...")},handleSizeChange:function(e){this.pageSize=e,this.currentPage=1,this.loadUsers()},handleCurrentChange:function(e){this.currentPage=e,this.loadUsers()},editUser:function(e){this.editForm={id:e.id,username:e.username,nickname:e.nickname,email:e.email,role:e.role,status:e.status},this.editDialogVisible=!0},saveUser:function(){var e=this;return(0,l.A)((0,n.A)().m(function t(){var a,r;return(0,n.A)().w(function(t){while(1)switch(t.p=t.n){case 0:return t.p=0,t.n=1,o.A.adminUser.update(e.editForm.id,{nickname:e.editForm.nickname,email:e.editForm.email,role:e.editForm.role,status:e.editForm.status});case 1:if(a=t.v,200!==a.code){t.n=3;break}return e.$message.success("用户信息更新成功"),e.editDialogVisible=!1,t.n=2,e.loadUsers();case 2:t.n=4;break;case 3:e.$message.error("更新用户信息失败: "+(a.message||"未知错误"));case 4:t.n=6;break;case 5:t.p=5,r=t.v,console.error("更新用户信息失败:",r),e.$message.error("更新用户信息失败: "+(r.message||"网络错误"));case 6:return t.a(2)}},t,null,[[0,5]])}))()},toggleUserStatus:function(e){var t=this;return(0,l.A)((0,n.A)().m(function a(){var r,s,l,i;return(0,n.A)().w(function(a){while(1)switch(a.p=a.n){case 0:return r=1===e.status?0:1,s=1===r?"启用":"禁用",a.p=1,a.n=2,t.$confirm("确定要".concat(s,"用户 ").concat(e.username," 吗？"),"确认操作",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"});case 2:return a.n=3,o.A.adminUser.updateStatus(e.id,r);case 3:if(l=a.v,200!==l.code){a.n=5;break}return t.$message.success("".concat(s,"用户成功")),a.n=4,t.loadUsers();case 4:a.n=6;break;case 5:t.$message.error("".concat(s,"用户失败: ")+(l.message||"未知错误"));case 6:a.n=8;break;case 7:a.p=7,i=a.v,"cancel"!==i&&(console.error("".concat(s,"用户失败:"),i),t.$message.error("".concat(s,"用户失败: ")+(i.message||"网络错误")));case 8:return a.a(2)}},a,null,[[1,7]])}))()},resetPassword:function(e){var t=this;return(0,l.A)((0,n.A)().m(function a(){var r,s;return(0,n.A)().w(function(a){while(1)switch(a.p=a.n){case 0:return a.p=0,a.n=1,t.$confirm("确定要重置用户 ".concat(e.username," 的密码吗？重置后密码将变为：123456"),"确认重置",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"});case 1:return a.n=2,o.A.adminUser.resetPassword(e.id);case 2:r=a.v,200===r.code?t.$message.success("密码重置成功，新密码为：123456"):t.$message.error("重置密码失败: "+(r.message||"未知错误")),a.n=4;break;case 3:a.p=3,s=a.v,"cancel"!==s&&(console.error("重置密码失败:",s),t.$message.error("重置密码失败: "+(s.message||"网络错误")));case 4:return a.a(2)}},a,null,[[0,3]])}))()},deleteUser:function(e){var t=this;return(0,l.A)((0,n.A)().m(function a(){var r,s;return(0,n.A)().w(function(a){while(1)switch(a.p=a.n){case 0:return a.p=0,a.n=1,t.$confirm("确定要删除用户 ".concat(e.username," 吗？此操作不可恢复！"),"确认删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"});case 1:return a.n=2,o.A.adminUser["delete"](e.id);case 2:if(r=a.v,200!==r.code){a.n=4;break}return t.$message.success("删除用户成功"),a.n=3,t.loadUsers();case 3:a.n=5;break;case 4:t.$message.error("删除用户失败: "+(r.message||"未知错误"));case 5:a.n=7;break;case 6:a.p=6,s=a.v,"cancel"!==s&&(console.error("删除用户失败:",s),t.$message.error("删除用户失败: "+(s.message||"网络错误")));case 7:return a.a(2)}},a,null,[[0,6]])}))()}}},c=i;var u=a(81656),m=(0,u.A)(c,r,s,!1,null,"cc594bfc",null);const d=m.exports}}]);
//# sourceMappingURL=476.f651da2e.js.map