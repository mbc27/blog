{"version":3,"file":"js/928.0f240d9c.js","mappings":"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","sources":["webpack://blog-frontend/./src/views/admin/PhotoManagement.vue","webpack://blog-frontend/src/views/admin/PhotoManagement.vue","webpack://blog-frontend/./src/views/admin/PhotoManagement.vue?8181","webpack://blog-frontend/./src/views/admin/PhotoManagement.vue?089a"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"photo-management\"},[_c('el-card',{attrs:{\"shadow\":\"hover\"}},[_c('div',{staticClass:\"clearfix\",attrs:{\"slot\":\"header\"},slot:\"header\"},[_c('span',[_vm._v(\"照片管理\")]),_c('el-button',{staticStyle:{\"float\":\"right\"},attrs:{\"type\":\"primary\",\"size\":\"small\"},on:{\"click\":_vm.handleAddPhoto}},[_vm._v(\"上传照片\")])],1),_c('el-form',{staticClass:\"search-form\",attrs:{\"inline\":true,\"model\":_vm.searchForm}},[_c('el-form-item',{attrs:{\"label\":\"相册分类\"}},[_c('el-select',{attrs:{\"placeholder\":\"选择相册分类\",\"clearable\":\"\"},model:{value:(_vm.searchForm.categoryId),callback:function ($$v) {_vm.$set(_vm.searchForm, \"categoryId\", $$v)},expression:\"searchForm.categoryId\"}},_vm._l((_vm.categories),function(item){return _c('el-option',{key:item.id,attrs:{\"label\":item.categoryName,\"value\":item.id}})}),1)],1),_c('el-form-item',[_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.searchPhotos}},[_vm._v(\"查询\")]),_c('el-button',{on:{\"click\":_vm.resetSearch}},[_vm._v(\"重置\")])],1)],1),_c('div',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.loading),expression:\"loading\"}],staticClass:\"photo-list\"},[(_vm.photos.length === 0)?_c('el-empty',{attrs:{\"description\":\"暂无照片\"}}):_c('div',{staticClass:\"photo-grid\"},_vm._l((_vm.photos),function(photo,index){return _c('div',{key:photo.id,staticClass:\"photo-item\"},[_c('el-card',{attrs:{\"body-style\":{ padding: '0px' },\"shadow\":\"hover\"}},[_c('div',{staticClass:\"photo-img-container\"},[_c('img',{staticClass:\"photo-img\",attrs:{\"src\":photo.url},on:{\"click\":function($event){return _vm.previewPhoto(index)}}})]),_c('div',{staticClass:\"photo-info\"},[_c('div',{staticClass:\"photo-title\"},[_vm._v(_vm._s(photo.description || '无描述'))]),_c('div',{staticClass:\"photo-category\"},[_vm._v(_vm._s(_vm.getCategoryName(photo.categoryId)))]),_c('div',{staticClass:\"photo-actions\"},[_c('el-button',{attrs:{\"type\":\"text\",\"size\":\"mini\"},on:{\"click\":function($event){return _vm.handleEdit(photo)}}},[_vm._v(\"编辑\")]),_c('el-button',{staticStyle:{\"color\":\"#F56C6C\"},attrs:{\"type\":\"text\",\"size\":\"mini\"},on:{\"click\":function($event){return _vm.handleDelete(photo)}}},[_vm._v(\"删除\")])],1)])])],1)}),0)],1),_c('div',{staticClass:\"pagination-container\"},[_c('el-pagination',{attrs:{\"current-page\":_vm.pagination.current,\"page-sizes\":[12, 24, 36, 48],\"page-size\":_vm.pagination.size,\"layout\":\"total, sizes, prev, pager, next, jumper\",\"total\":_vm.pagination.total},on:{\"size-change\":_vm.handleSizeChange,\"current-change\":_vm.handleCurrentChange}})],1)],1),_c('el-dialog',{attrs:{\"title\":_vm.dialogTitle,\"visible\":_vm.dialogVisible,\"width\":\"500px\"},on:{\"update:visible\":function($event){_vm.dialogVisible=$event}}},[_c('el-form',{ref:\"photoForm\",attrs:{\"model\":_vm.photoForm,\"rules\":_vm.photoRules,\"label-width\":\"100px\"}},[_c('el-form-item',{attrs:{\"label\":\"相册分类\",\"prop\":\"categoryId\"}},[_c('el-select',{attrs:{\"placeholder\":\"请选择相册分类\"},model:{value:(_vm.photoForm.categoryId),callback:function ($$v) {_vm.$set(_vm.photoForm, \"categoryId\", $$v)},expression:\"photoForm.categoryId\"}},_vm._l((_vm.categories),function(item){return _c('el-option',{key:item.id,attrs:{\"label\":item.categoryName,\"value\":item.id}})}),1)],1),_c('el-form-item',{attrs:{\"label\":\"照片描述\",\"prop\":\"description\"}},[_c('el-input',{attrs:{\"type\":\"textarea\",\"rows\":3,\"placeholder\":\"请输入照片描述\"},model:{value:(_vm.photoForm.description),callback:function ($$v) {_vm.$set(_vm.photoForm, \"description\", $$v)},expression:\"photoForm.description\"}})],1),(!_vm.photoForm.id)?_c('el-form-item',{attrs:{\"label\":\"照片\",\"prop\":\"url\"}},[_c('el-upload',{staticClass:\"upload-container\",attrs:{\"action\":\"http://localhost:8080/api/upload/image\",\"headers\":_vm.uploadHeaders,\"show-file-list\":false,\"on-success\":_vm.handleUploadSuccess,\"before-upload\":_vm.beforePhotoUpload}},[(_vm.photoForm.url)?_c('img',{staticClass:\"upload-img\",attrs:{\"src\":_vm.photoForm.url}}):_c('i',{staticClass:\"el-icon-plus upload-icon\"}),(!_vm.photoForm.url)?_c('div',{staticClass:\"upload-tip\"},[_vm._v(\"点击上传照片\")]):_vm._e()])],1):_c('el-form-item',{attrs:{\"label\":\"照片\"}},[_c('img',{staticClass:\"preview-img\",attrs:{\"src\":_vm.photoForm.url}})])],1),_c('div',{staticClass:\"dialog-footer\",attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('el-button',{on:{\"click\":function($event){_vm.dialogVisible = false}}},[_vm._v(\"取 消\")]),_c('el-button',{attrs:{\"type\":\"primary\",\"loading\":_vm.submitLoading},on:{\"click\":_vm.submitPhoto}},[_vm._v(\"确 定\")])],1)],1),_c('el-dialog',{attrs:{\"visible\":_vm.previewVisible,\"append-to-body\":\"\",\"width\":\"800px\"},on:{\"update:visible\":function($event){_vm.previewVisible=$event}}},[_c('img',{staticStyle:{\"width\":\"100%\"},attrs:{\"src\":_vm.previewUrl,\"alt\":\"Preview Image\"}})])],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"photo-management\">\n    <el-card shadow=\"hover\">\n      <div slot=\"header\" class=\"clearfix\">\n        <span>照片管理</span>\n        <el-button style=\"float: right\" type=\"primary\" size=\"small\" @click=\"handleAddPhoto\">上传照片</el-button>\n      </div>\n      \n      <el-form :inline=\"true\" :model=\"searchForm\" class=\"search-form\">\n        <el-form-item label=\"相册分类\">\n          <el-select v-model=\"searchForm.categoryId\" placeholder=\"选择相册分类\" clearable>\n            <el-option\n              v-for=\"item in categories\"\n              :key=\"item.id\"\n              :label=\"item.categoryName\"\n              :value=\"item.id\">\n            </el-option>\n          </el-select>\n        </el-form-item>\n        <el-form-item>\n          <el-button type=\"primary\" @click=\"searchPhotos\">查询</el-button>\n          <el-button @click=\"resetSearch\">重置</el-button>\n        </el-form-item>\n      </el-form>\n      \n      <div class=\"photo-list\" v-loading=\"loading\">\n        <el-empty description=\"暂无照片\" v-if=\"photos.length === 0\"></el-empty>\n        <div class=\"photo-grid\" v-else>\n          <div class=\"photo-item\" v-for=\"(photo, index) in photos\" :key=\"photo.id\">\n            <el-card :body-style=\"{ padding: '0px' }\" shadow=\"hover\">\n              <div class=\"photo-img-container\">\n                <img :src=\"photo.url\" class=\"photo-img\" @click=\"previewPhoto(index)\">\n              </div>\n              <div class=\"photo-info\">\n                <div class=\"photo-title\">{{ photo.description || '无描述' }}</div>\n                <div class=\"photo-category\">{{ getCategoryName(photo.categoryId) }}</div>\n                <div class=\"photo-actions\">\n                  <el-button type=\"text\" size=\"mini\" @click=\"handleEdit(photo)\">编辑</el-button>\n                  <el-button type=\"text\" size=\"mini\" style=\"color: #F56C6C\" @click=\"handleDelete(photo)\">删除</el-button>\n                </div>\n              </div>\n            </el-card>\n          </div>\n        </div>\n      </div>\n      \n      <div class=\"pagination-container\">\n        <el-pagination\n          @size-change=\"handleSizeChange\"\n          @current-change=\"handleCurrentChange\"\n          :current-page=\"pagination.current\"\n          :page-sizes=\"[12, 24, 36, 48]\"\n          :page-size=\"pagination.size\"\n          layout=\"total, sizes, prev, pager, next, jumper\"\n          :total=\"pagination.total\">\n        </el-pagination>\n      </div>\n    </el-card>\n\n    <!-- 照片上传/编辑对话框 -->\n    <el-dialog :title=\"dialogTitle\" :visible.sync=\"dialogVisible\" width=\"500px\">\n      <el-form :model=\"photoForm\" :rules=\"photoRules\" ref=\"photoForm\" label-width=\"100px\">\n        <el-form-item label=\"相册分类\" prop=\"categoryId\">\n          <el-select v-model=\"photoForm.categoryId\" placeholder=\"请选择相册分类\">\n            <el-option\n              v-for=\"item in categories\"\n              :key=\"item.id\"\n              :label=\"item.categoryName\"\n              :value=\"item.id\">\n            </el-option>\n          </el-select>\n        </el-form-item>\n        <el-form-item label=\"照片描述\" prop=\"description\">\n          <el-input type=\"textarea\" v-model=\"photoForm.description\" :rows=\"3\" placeholder=\"请输入照片描述\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"照片\" prop=\"url\" v-if=\"!photoForm.id\">\n          <el-upload\n            class=\"upload-container\"\n            action=\"http://localhost:8080/api/upload/image\"\n            :headers=\"uploadHeaders\"\n            :show-file-list=\"false\"\n            :on-success=\"handleUploadSuccess\"\n            :before-upload=\"beforePhotoUpload\">\n            <img v-if=\"photoForm.url\" :src=\"photoForm.url\" class=\"upload-img\">\n            <i v-else class=\"el-icon-plus upload-icon\"></i>\n            <div class=\"upload-tip\" v-if=\"!photoForm.url\">点击上传照片</div>\n          </el-upload>\n        </el-form-item>\n        <el-form-item label=\"照片\" v-else>\n          <img :src=\"photoForm.url\" class=\"preview-img\">\n        </el-form-item>\n      </el-form>\n      <div slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"dialogVisible = false\">取 消</el-button>\n        <el-button type=\"primary\" @click=\"submitPhoto\" :loading=\"submitLoading\">确 定</el-button>\n      </div>\n    </el-dialog>\n\n    <!-- 照片预览 -->\n    <el-dialog :visible.sync=\"previewVisible\" append-to-body width=\"800px\">\n      <img :src=\"previewUrl\" alt=\"Preview Image\" style=\"width: 100%;\">\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nimport axios from 'axios'\nimport { mapGetters } from 'vuex'\n\nexport default {\n  name: 'PhotoManagement',\n  data() {\n    return {\n      searchForm: {\n        categoryId: ''\n      },\n      photos: [],\n      categories: [],\n      loading: false,\n      pagination: {\n        current: 1,\n        size: 12,\n        total: 0\n      },\n      dialogVisible: false,\n      dialogTitle: '上传照片',\n      photoForm: {\n        id: null,\n        categoryId: '',\n        description: '',\n        url: ''\n      },\n      photoRules: {\n        categoryId: [\n          { required: true, message: '请选择相册分类', trigger: 'change' }\n        ],\n        url: [\n          { required: true, message: '请上传照片', trigger: 'change' }\n        ]\n      },\n      submitLoading: false,\n      previewVisible: false,\n      previewUrl: ''\n    }\n  },\n  computed: {\n    ...mapGetters(['token']),\n    uploadHeaders() {\n      return {\n        'Authorization': `Bearer ${this.token}`\n      }\n    }\n  },\n  created() {\n    this.fetchCategories()\n    this.fetchPhotos()\n  },\n  methods: {\n    // 获取完整的图片URL\n    getFullImageUrl(url) {\n      if (!url) return ''\n      // 如果已经是完整URL，直接返回\n      if (url.startsWith('http')) {\n        return url\n      }\n      // 如果是相对路径，添加服务器地址\n      if (url.startsWith('/')) {\n        return `http://localhost:8080${url}`\n      }\n      // 如果不是以/开头，也添加服务器地址和/uploads/前缀\n      return `http://localhost:8080/uploads/${url}`\n    },\n    fetchCategories() {\n      axios.get('/api/photo/category/list', {\n        headers: {\n          Authorization: this.token\n        }\n      })\n        .then(response => {\n          console.log('Categories response:', response.data)\n          const data = response.data.data || response.data\n          this.categories = Array.isArray(data) ? data.map(item => ({\n            ...item,\n            categoryName: item.categoryName || item.name\n          })) : []\n        })\n        .catch(error => {\n          console.error('获取相册分类失败', error)\n          this.$message.error('获取相册分类失败')\n        })\n    },\n    fetchPhotos() {\n      this.loading = true\n      const params = {\n        current: this.pagination.current,\n        size: this.pagination.size,\n        ...this.searchForm\n      }\n      \n      axios.get('/api/admin/photos', { \n        params,\n        headers: {\n          Authorization: this.token\n        }\n      })\n        .then(response => {\n          if (response.data && response.data.data) {\n            let photos = response.data.data.records || response.data.data\n            // 确保照片URL指向后端服务器\n            photos = photos.map(photo => ({\n              ...photo,\n              url: this.getFullImageUrl(photo.url)\n            }))\n            this.photos = photos\n            this.pagination.total = response.data.data.total || 0\n          }\n        })\n        .catch(error => {\n          console.error('获取照片列表失败', error)\n          this.$message.error('获取照片列表失败')\n        })\n        .finally(() => {\n          this.loading = false\n        })\n    },\n    getCategoryName(categoryId) {\n      const category = this.categories.find(item => item.id === categoryId)\n      return category ? (category.categoryName || category.name) : '未分类'\n    },\n    searchPhotos() {\n      this.pagination.current = 1\n      this.fetchPhotos()\n    },\n    resetSearch() {\n      this.searchForm = {\n        categoryId: ''\n      }\n      this.searchPhotos()\n    },\n    handleSizeChange(val) {\n      this.pagination.size = val\n      this.fetchPhotos()\n    },\n    handleCurrentChange(val) {\n      this.pagination.current = val\n      this.fetchPhotos()\n    },\n    handleAddPhoto() {\n      this.dialogTitle = '上传照片'\n      this.photoForm = {\n        id: null,\n        categoryId: '',\n        description: '',\n        url: ''\n      }\n      this.dialogVisible = true\n      this.$nextTick(() => {\n        this.$refs.photoForm && this.$refs.photoForm.clearValidate()\n      })\n    },\n    handleEdit(photo) {\n      this.dialogTitle = '编辑照片'\n      this.photoForm = {\n        id: photo.id,\n        categoryId: photo.categoryId,\n        description: photo.description,\n        url: photo.url\n      }\n      this.dialogVisible = true\n      this.$nextTick(() => {\n        this.$refs.photoForm && this.$refs.photoForm.clearValidate()\n      })\n    },\n    handleDelete(photo) {\n      this.$confirm('确认删除该照片吗？', '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(() => {\n        const token = localStorage.getItem('token')\n        axios.delete(`/api/admin/photos/${photo.id}`, {\n          headers: {\n            'Authorization': token ? `Bearer ${token}` : ''\n          }\n        })\n          .then(() => {\n            this.$message.success('删除成功')\n            this.fetchPhotos()\n          })\n          .catch(error => {\n            console.error('删除照片失败', error)\n            this.$message.error('删除照片失败')\n          })\n      }).catch(() => {})\n    },\n    handleUploadSuccess(res) {\n      console.log('上传响应:', res);\n      if (res.code === 200) {\n        // 确保图片URL指向后端服务器\n        this.photoForm.url = this.getFullImageUrl(res.message);\n        this.$message.success('上传成功');\n        // 立即刷新照片列表以显示新上传的照片\n        this.fetchPhotos();\n      } else {\n        this.$message.error('上传失败');\n      }\n    },\n    beforePhotoUpload(file) {\n      const isJPG = file.type === 'image/jpeg' || file.type === 'image/png' || file.type === 'image/gif'\n      const isLt2M = file.size / 1024 / 1024 < 2\n\n      if (!isJPG) {\n        this.$message.error('上传头像图片只能是 JPG/PNG/GIF 格式!')\n      }\n      if (!isLt2M) {\n        this.$message.error('上传头像图片大小不能超过 2MB!')\n      }\n      return isJPG && isLt2M\n    },\n    submitPhoto() {\n      this.$refs.photoForm.validate((valid) => {\n        if (valid) {\n          this.submitLoading = true\n          const method = this.photoForm.id ? 'put' : 'post'\n          const url = this.photoForm.id ? `/api/admin/photos/${this.photoForm.id}` : '/api/admin/photos'\n          \n          axios[method](url, this.photoForm, {\n            headers: {\n              'Authorization': `Bearer ${this.token}`\n            }\n          })\n            .then(() => {\n              this.$message.success(this.photoForm.id ? '更新成功' : '添加成功')\n              this.dialogVisible = false\n              // 重置分页到第一页以确保能看到新添加的照片\n              this.pagination.current = 1\n              this.fetchPhotos()\n            })\n            .catch(error => {\n              console.error('提交照片失败', error)\n              this.$message.error(this.photoForm.id ? '更新照片失败' : '添加照片失败')\n            })\n            .finally(() => {\n              this.submitLoading = false\n            })\n        }\n      })\n    },\n    previewPhoto(index) {\n      this.previewUrl = this.photos[index].url\n      this.previewVisible = true\n    }\n  }\n}\n</script>\n\n<style scoped>\n.photo-management {\n  padding: 20px;\n}\n\n.search-form {\n  margin-bottom: 20px;\n}\n\n.photo-grid {\n  display: grid;\n  grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));\n  gap: 20px;\n  margin-bottom: 20px;\n}\n\n.photo-item {\n  border-radius: 8px;\n  overflow: hidden;\n}\n\n.photo-img-container {\n  height: 150px;\n  overflow: hidden;\n}\n\n.photo-img {\n  width: 100%;\n  height: 100%;\n  object-fit: cover;\n  cursor: pointer;\n  transition: transform 0.3s;\n}\n\n.photo-img:hover {\n  transform: scale(1.05);\n}\n\n.photo-info {\n  padding: 10px;\n}\n\n.photo-title {\n  font-size: 14px;\n  font-weight: bold;\n  margin-bottom: 5px;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n}\n\n.photo-category {\n  font-size: 12px;\n  color: #999;\n  margin-bottom: 10px;\n}\n\n.photo-actions {\n  display: flex;\n  justify-content: space-between;\n}\n\n.pagination-container {\n  display: flex;\n  justify-content: center;\n  margin-top: 20px;\n}\n\n.upload-container {\n  width: 100px;\n  height: 100px;\n  border: 1px dashed #d9d9d9;\n  border-radius: 6px;\n  cursor: pointer;\n  position: relative;\n  overflow: hidden;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n}\n\n.upload-container:hover {\n  border-color: #409EFF;\n}\n\n.upload-icon {\n  font-size: 28px;\n  color: #8c939d;\n  margin-bottom: 10px;\n}\n\n.upload-img {\n  width: 100%;\n  height: 100%;\n  object-fit: cover;\n}\n\n.upload-tip {\n  color: #8c939d;\n  font-size: 14px;\n}\n\n.preview-img {\n  max-width: 200px;\n  max-height: 200px;\n}\n</style>","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./PhotoManagement.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./PhotoManagement.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./PhotoManagement.vue?vue&type=template&id=345a69de&scoped=true\"\nimport script from \"./PhotoManagement.vue?vue&type=script&lang=js\"\nexport * from \"./PhotoManagement.vue?vue&type=script&lang=js\"\nimport style0 from \"./PhotoManagement.vue?vue&type=style&index=0&id=345a69de&prod&scoped=true&lang=css\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"345a69de\",\n  null\n  \n)\n\nexport default component.exports"],"names":["render","_vm","this","_c","_self","staticClass","attrs","slot","_v","staticStyle","on","handleAddPhoto","searchForm","model","value","categoryId","callback","$$v","$set","expression","_l","categories","item","key","id","categoryName","searchPhotos","resetSearch","directives","name","rawName","loading","photos","length","photo","index","padding","url","$event","previewPhoto","_s","description","getCategoryName","handleEdit","handleDelete","pagination","current","size","total","handleSizeChange","handleCurrentChange","dialogTitle","dialogVisible","ref","photoForm","photoRules","uploadHeaders","handleUploadSuccess","beforePhotoUpload","_e","submitLoading","submitPhoto","previewVisible","previewUrl","staticRenderFns","data","required","message","trigger","computed","_objectSpread","mapGetters","concat","token","created","fetchCategories","fetchPhotos","methods","getFullImageUrl","startsWith","_this","axios","headers","Authorization","then","response","console","log","Array","isArray","map","error","$message","_this2","params","records","category","find","val","_this3","$nextTick","$refs","clearValidate","_this4","_this5","$confirm","confirmButtonText","cancelButtonText","type","localStorage","getItem","success","res","code","file","isJPG","isLt2M","_this6","validate","valid","method","component"],"sourceRoot":""}