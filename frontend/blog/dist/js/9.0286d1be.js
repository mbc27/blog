"use strict";(self["webpackChunkblog_frontend"]=self["webpackChunkblog_frontend"]||[]).push([[9],{64009:(t,e,i)=>{i.r(e),i.d(e,{default:()=>y});i(62010);var n=function(){var t=this,e=t._self._c;return e("div",{staticClass:"article-detail-container"},[e("el-card",{staticClass:"article-card"},[e("div",{staticClass:"header",attrs:{slot:"header"},slot:"header"},[e("h1",[t._v(t._s(t.article.title))]),e("div",{staticClass:"article-meta"},[e("span",{staticClass:"author"},[t._v("ä½œè€…: "+t._s(t.article.authorName||"æœªçŸ¥"))]),e("span",{staticClass:"time"},[t._v("å‘å¸ƒæ—¶é—´: "+t._s(t.formatDate(t.article.createTime)))]),e("span",{staticClass:"views"},[t._v("é˜…è¯»: "+t._s(t.article.viewCount))]),e("span",{staticClass:"likes"},[t._v("ç‚¹èµ: "+t._s(t.article.likeCount))]),e("span",{staticClass:"status",class:t.getStatusClass(t.article.status)},[t._v(" "+t._s(t.getStatusText(t.article.status))+" ")])]),t.isAdmin&&2===t.article.status?e("div",{staticClass:"admin-actions"},[e("el-button",{attrs:{type:"success",size:"small"},on:{click:t.approveArticle}},[t._v("å®¡æ ¸é€šè¿‡")]),e("el-button",{attrs:{type:"danger",size:"small"},on:{click:t.rejectArticle}},[t._v("å®¡æ ¸æ‹’ç»")])],1):t._e(),!t.isAuthor||2!==t.article.status&&3!==t.article.status?t._e():e("div",{staticClass:"author-actions"},[e("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.editArticle}},[t._v("ç¼–è¾‘æ–‡ç« ")])],1)]),e("div",{staticClass:"article-content",domProps:{innerHTML:t._s(t.article.content)}}),e("div",{staticClass:"article-footer"},[e("el-button",{attrs:{type:t.isLiked?"success":"primary",icon:t.isLiked?"el-icon-star-on":"el-icon-thumb",loading:t.liking},on:{click:t.toggleLike}},[t._v(" "+t._s(t.isLiked?"å·²ç‚¹èµ":"ç‚¹èµ")+" "+t._s(t.article.likeCount)+" ")]),t.article.tags&&t.article.tags.length?e("div",{staticClass:"tags"},t._l(t.article.tags,function(i){return e("el-tag",{key:i.id,attrs:{type:i.color||"info",size:"small"}},[t._v(" "+t._s(i.name)+" ")])}),1):t._e()],1)]),t.article.id?e("el-card",{staticClass:"comments-card"},[e("div",{staticClass:"comments-header",attrs:{slot:"header"},slot:"header"},[e("div",{staticClass:"comments-title"},[e("i",{staticClass:"el-icon-chat-dot-round"}),e("span",[t._v("è¯„è®º ("+t._s(t.commentCount)+")")])]),t.commentCount>0?e("div",{staticClass:"comments-info"},[e("el-tooltip",{attrs:{content:"è¯„è®ºè§„åˆ™",placement:"top"}},[e("i",{staticClass:"el-icon-info"})]),e("span",[t._v("æ–‡æ˜è¯„è®ºï¼Œç†æ€§å‘è¨€")])],1):t._e()]),e("comment-section",{attrs:{"article-id":t.article.id},on:{"comment-count-updated":t.updateCommentCount}})],1):t._e()],1)},s=[],a=i(20908),r=i(30388),c=(i(16280),i(76918),i(28706),i(44114),i(23288),i(68156),i(76031),function(){var t=this,e=t._self._c;return e("div",{staticClass:"comment-section"},[e("div",{staticClass:"comment-input-container"},[e("div",{staticClass:"comment-input-header"},[t.isAuthenticated?e("div",{staticClass:"user-info"},[e("el-avatar",{attrs:{src:t.user.avatar||t.defaultAvatar,size:"small"}}),e("span",{staticClass:"username"},[t._v(t._s(t.user.nickname||"æˆ‘"))])],1):e("div",{staticClass:"comment-tips"},[e("i",{staticClass:"el-icon-info"}),e("span",[t._v("ç™»å½•åæ‰èƒ½å‘è¡¨è¯„è®º")])])]),e("div",{staticClass:"comment-input"},[e("el-input",{staticClass:"comment-textarea",attrs:{type:"textarea",rows:3,placeholder:t.isAuthenticated?"è¯´ç‚¹ä»€ä¹ˆå§...":"è¯·ç™»å½•åå‘è¡¨è¯„è®º",disabled:!t.isAuthenticated},model:{value:t.newComment,callback:function(e){t.newComment=e},expression:"newComment"}}),e("div",{staticClass:"comment-toolbar"},[e("div",{staticClass:"emoji-picker"},[e("el-button",{staticClass:"emoji-button",attrs:{type:"text",disabled:!t.isAuthenticated},on:{click:t.toggleEmojiPanel}},[e("i",{staticClass:"el-icon-sunny"}),t._v(" è¡¨æƒ… ")]),e("div",{directives:[{name:"show",rawName:"v-show",value:t.showEmojiPicker,expression:"showEmojiPicker"}],staticClass:"emoji-panel"},[e("div",{staticClass:"emoji-container"},[e("div",{staticClass:"emoji-categories"},t._l(t.emojiCategories,function(i,n){return e("span",{key:n,class:["emoji-category",{active:t.currentEmojiCategory===n}],on:{click:function(e){t.currentEmojiCategory=n}}},[t._v(" "+t._s(i.icon)+" ")])}),0),e("div",{staticClass:"emoji-list"},t._l(t.currentCategoryEmojis,function(i){return e("span",{key:i,staticClass:"emoji-item",on:{click:function(e){return t.insertEmoji(i)}}},[t._v(" "+t._s(i)+" ")])}),0)])])],1),e("div",{staticClass:"comment-actions"},[t.isAuthenticated?e("el-button",{attrs:{type:"primary",size:"small",loading:t.submitting,icon:"el-icon-s-promotion"},on:{click:t.submitComment}},[t._v(" å‘è¡¨è¯„è®º ")]):e("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-user"},on:{click:t.goToLogin}},[t._v(" ç™»å½•åè¯„è®º ")])],1)])],1)]),t.comments.length?e("div",{staticClass:"comment-list"},t._l(t.comments,function(i){return e("div",{key:i.id,staticClass:"comment-item"},[e("div",{staticClass:"comment-header"},[e("el-avatar",{attrs:{src:i.avatar||t.defaultAvatar,size:"small"}}),e("span",{staticClass:"comment-author"},[t._v(t._s(i.nickname))]),e("span",{staticClass:"comment-time"},[t._v(t._s(t.formatTime(i.createTime)))])],1),e("div",{staticClass:"comment-content"},[t._v(t._s(i.content))]),e("div",{staticClass:"comment-actions-bar"},[e("el-button",{attrs:{type:"text",size:"mini",icon:"el-icon-chat-dot-round"},on:{click:function(e){return t.toggleReplyInput(i.id)}}},[t._v(" å›å¤ ("+t._s(i.replyCount||0)+") ")]),e("span",{staticClass:"comment-like"},[e("i",{staticClass:"el-icon-thumb"}),t._v(" "+t._s(i.likeCount||0)+" ")])],1),t.replyingTo===i.id?e("div",{staticClass:"reply-input"},[e("el-input",{staticClass:"reply-textarea",attrs:{type:"textarea",rows:2,placeholder:"å›å¤ @".concat(i.nickname)},model:{value:t.replyContent,callback:function(e){t.replyContent=e},expression:"replyContent"}}),e("div",{staticClass:"reply-toolbar"},[e("div",{staticClass:"emoji-picker"},[e("el-button",{staticClass:"emoji-button",attrs:{type:"text"},on:{click:t.toggleReplyEmojiPanel}},[e("i",{staticClass:"el-icon-sunny"}),t._v(" è¡¨æƒ… ")]),e("div",{directives:[{name:"show",rawName:"v-show",value:t.showReplyEmojiPicker,expression:"showReplyEmojiPicker"}],staticClass:"emoji-panel"},[e("div",{staticClass:"emoji-container"},[e("div",{staticClass:"emoji-categories"},t._l(t.emojiCategories,function(i,n){return e("span",{key:n,class:["emoji-category",{active:t.currentEmojiCategory===n}],on:{click:function(e){t.currentEmojiCategory=n}}},[t._v(" "+t._s(i.icon)+" ")])}),0),e("div",{staticClass:"emoji-list"},t._l(t.currentCategoryEmojis,function(i){return e("span",{key:i,staticClass:"emoji-item",on:{click:function(e){return t.insertReplyEmoji(i)}}},[t._v(" "+t._s(i)+" ")])}),0)])])],1),e("div",{staticClass:"reply-actions"},[e("el-button",{attrs:{size:"mini",icon:"el-icon-close"},on:{click:t.cancelReply}},[t._v("å–æ¶ˆ")]),e("el-button",{attrs:{type:"primary",size:"mini",loading:t.replySubmitting,icon:"el-icon-s-promotion"},on:{click:function(e){return t.submitReply(i)}}},[t._v(" å›å¤ ")])],1)])],1):t._e(),i.children&&i.children.length?e("div",{staticClass:"child-comments"},t._l(i.children,function(n){return e("div",{key:n.id,staticClass:"child-comment-item"},[e("div",{staticClass:"comment-header"},[e("el-avatar",{attrs:{src:n.avatar||t.defaultAvatar,size:"small"}}),e("span",{staticClass:"comment-author"},[t._v(t._s(n.nickname))]),n.replyToNickname?e("span",{staticClass:"reply-to"},[t._v(" å›å¤ @"+t._s(n.replyToNickname)+" ")]):t._e(),e("span",{staticClass:"comment-time"},[t._v(t._s(t.formatTime(n.createTime)))])],1),e("div",{staticClass:"comment-content"},[t._v(t._s(n.content))]),e("div",{staticClass:"comment-actions-bar"},[e("el-button",{attrs:{type:"text",size:"mini",icon:"el-icon-chat-dot-round"},on:{click:function(e){return t.replyToChild(i,n)}}},[t._v(" å›å¤ ")]),e("span",{staticClass:"comment-like"},[e("i",{staticClass:"el-icon-thumb"}),t._v(" "+t._s(n.likeCount||0)+" ")])],1)])}),0):t._e()])}),0):e("div",{staticClass:"no-comments"},[e("i",{staticClass:"el-icon-chat-dot-round no-comments-icon"}),e("p",[t._v("æš‚æ— è¯„è®ºï¼Œå¿«æ¥å‘è¡¨ç¬¬ä¸€æ¡è¯„è®ºå§ï¼")]),t.isAuthenticated?e("el-button",{attrs:{type:"primary",size:"small",plain:""},on:{click:t.focusCommentInput}},[t._v(" å†™ä¸‹æˆ‘çš„è¯„è®º ")]):e("el-button",{attrs:{type:"primary",size:"small",plain:""},on:{click:t.goToLogin}},[t._v(" ç™»å½•åè¯„è®º ")])],1),t.pagination.total>t.pagination.size?e("el-pagination",{staticClass:"pagination",attrs:{"current-page":t.pagination.current,"page-sizes":[5,10,20,50],"page-size":t.pagination.size,layout:"total, sizes, prev, pager, next, jumper",total:t.pagination.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}}):t._e()],1)}),o=[],l=i(41034),u=(i(2008),i(62062),i(18111),i(22489),i(61701),i(2892),i(26099),i(42762),i(93518)),m=i(31552);const d={name:"CommentSection",props:{articleId:{type:[String,Number],required:!0}},data:function(){return{comments:[],newComment:"",submitting:!1,replyingTo:null,replyContent:"",replySubmitting:!1,defaultAvatar:"https://cube.elemecdn.com/3/7c/3ea6beec64369c2642b92c6726f1epng.png",pagination:{current:1,size:10,total:0},showEmojiPicker:!1,showReplyEmojiPicker:!1,currentEmojiCategory:0,emojiCategories:[{name:"è¡¨æƒ…",icon:"ğŸ˜€",emojis:["ğŸ˜€","ğŸ˜ƒ","ğŸ˜„","ğŸ˜","ğŸ˜†","ğŸ˜…","ğŸ˜‚","ğŸ¤£","ğŸ˜Š","ğŸ˜‡","ğŸ™‚","ğŸ™ƒ","ğŸ˜‰","ğŸ˜Œ","ğŸ˜","ğŸ¥°","ğŸ˜˜","ğŸ˜—","ğŸ˜™","ğŸ˜š","ğŸ˜‹","ğŸ˜›","ğŸ˜","ğŸ˜œ","ğŸ¤ª","ğŸ¤¨","ğŸ§","ğŸ¤“","ğŸ˜","ğŸ¤©","ğŸ¥³"]},{name:"æ‰‹åŠ¿",icon:"ğŸ‘",emojis:["ğŸ‘","ğŸ‘","ğŸ‘Œ","âœŒï¸","ğŸ¤","ğŸ¤Ÿ","ğŸ¤˜","ğŸ¤™","ğŸ‘ˆ","ğŸ‘‰","ğŸ‘†","ğŸ‘‡","â˜ï¸","ğŸ‘‹","ğŸ¤š","ğŸ–ï¸","âœ‹","ğŸ––","ğŸ‘","ğŸ™Œ","ğŸ‘","ğŸ¤²","ğŸ¤","ğŸ™","âœï¸"]},{name:"åŠ¨ç‰©",icon:"ğŸ±",emojis:["ğŸ±","ğŸ¶","ğŸ­","ğŸ¹","ğŸ°","ğŸ¦Š","ğŸ»","ğŸ¼","ğŸ¨","ğŸ¯","ğŸ¦","ğŸ®","ğŸ·","ğŸ¸","ğŸµ","ğŸ”","ğŸ§","ğŸ¦","ğŸ¤","ğŸ¦†","ğŸ¦…","ğŸ¦‰","ğŸ¦‡","ğŸº","ğŸ—","ğŸ´","ğŸ¦„","ğŸ","ğŸ›","ğŸ¦‹","ğŸŒ"]},{name:"é£Ÿç‰©",icon:"ğŸ",emojis:["ğŸ","ğŸ","ğŸŠ","ğŸ‹","ğŸŒ","ğŸ‰","ğŸ‡","ğŸ“","ğŸˆ","ğŸ’","ğŸ‘","ğŸ¥­","ğŸ","ğŸ¥¥","ğŸ¥","ğŸ…","ğŸ†","ğŸ¥‘","ğŸ¥¦","ğŸ¥¬","ğŸ¥’","ğŸŒ¶ï¸","ğŸŒ½","ğŸ¥•","ğŸ§„","ğŸ§…","ğŸ¥”","ğŸ ","ğŸ¥","ğŸ¥¯","ğŸ"]},{name:"çˆ±å¿ƒ",icon:"â¤ï¸",emojis:["â¤ï¸","ğŸ§¡","ğŸ’›","ğŸ’š","ğŸ’™","ğŸ’œ","ğŸ–¤","ğŸ¤","ğŸ¤","ğŸ’”","â£ï¸","ğŸ’•","ğŸ’","ğŸ’“","ğŸ’—","ğŸ’–","ğŸ’˜","ğŸ’","ğŸ’Ÿ","â˜®ï¸","âœï¸","â˜ªï¸","ğŸ•‰ï¸","â˜¸ï¸","âœ¡ï¸","ğŸ”¯","ğŸ•","â˜¯ï¸","â˜¦ï¸","ğŸ›","â›"]}]}},computed:(0,l.A)((0,l.A)({},(0,u.L8)(["isAuthenticated","user"])),{},{currentCategoryEmojis:function(){return this.currentEmojiCategory>=0&&this.currentEmojiCategory<this.emojiCategories.length?this.emojiCategories[this.currentEmojiCategory].emojis:[]}}),watch:{articleId:{immediate:!0,handler:function(){this.articleId&&this.getComments()}}},methods:{focusCommentInput:function(){var t=this;this.$nextTick(function(){var e=t.$el.querySelector(".comment-textarea textarea");e&&e.focus()})},toggleEmojiPanel:function(){var t=this;this.showEmojiPicker=!this.showEmojiPicker,this.showEmojiPicker&&(this.showReplyEmojiPicker=!1),this.showEmojiPicker&&this.$nextTick(function(){var e=function(i){t.$el.querySelector(".emoji-picker").contains(i.target)||(t.showEmojiPicker=!1,document.removeEventListener("click",e))};setTimeout(function(){document.addEventListener("click",e)},100)})},toggleReplyEmojiPanel:function(){var t=this;this.showReplyEmojiPicker=!this.showReplyEmojiPicker,this.showReplyEmojiPicker&&(this.showEmojiPicker=!1),this.showReplyEmojiPicker&&this.$nextTick(function(){var e=function(i){var n=t.$el.querySelector(".reply-input .emoji-picker");n&&!n.contains(i.target)&&(t.showReplyEmojiPicker=!1,document.removeEventListener("click",e))};setTimeout(function(){document.addEventListener("click",e)},100)})},insertEmoji:function(t){this.newComment+=t,this.showEmojiPicker=!1},insertReplyEmoji:function(t){this.replyContent+=t,this.showReplyEmojiPicker=!1},getComments:function(){var t=this;return(0,r.A)((0,a.A)().m(function e(){var i,n,s,r;return(0,a.A)().w(function(e){while(1)switch(e.p=e.n){case 0:return e.p=0,i={current:t.pagination.current,size:t.pagination.size},e.n=1,m.A.comment.getByArticle(t.articleId,i);case 1:n=e.v,200===n.code&&(s=n.data.records||[],t.comments=s.filter(function(t){return 1===t.level||!t.parentId}).map(function(e){return(0,l.A)((0,l.A)({},e),{},{nickname:e.user?e.user.nickname:e.nickname||"åŒ¿åç”¨æˆ·",avatar:e.user?e.user.avatar:e.avatar||t.defaultAvatar,replyCount:e.children?e.children.length:0,likeCount:e.likeCount||0,isLiked:e.isLiked||!1,children:(e.children||[]).map(function(e){return(0,l.A)((0,l.A)({},e),{},{nickname:e.user?e.user.nickname:e.nickname||"åŒ¿åç”¨æˆ·",avatar:e.user?e.user.avatar:e.avatar||t.defaultAvatar,replyToNickname:e.replyToUser?e.replyToUser.nickname:e.replyToNickname,likeCount:e.likeCount||0,isLiked:e.isLiked||!1})})})}),t.pagination.total=n.data.total||0,t.$emit("comment-count-updated",t.pagination.total)),e.n=3;break;case 2:e.p=2,r=e.v,console.error("è·å–è¯„è®ºå¤±è´¥:",r),t.comments=[],t.pagination.total=0;case 3:return e.a(2)}},e,null,[[0,2]])}))()},submitComment:function(){var t=this;return(0,r.A)((0,a.A)().m(function e(){var i,n,s;return(0,a.A)().w(function(e){while(1)switch(e.p=e.n){case 0:if(t.isAuthenticated){e.n=1;break}return t.goToLogin(),e.a(2);case 1:if(t.newComment.trim()){e.n=2;break}return t.$message.warning("è¯„è®ºå†…å®¹ä¸èƒ½ä¸ºç©º"),e.a(2);case 2:return t.submitting=!0,e.p=3,i={articleId:t.articleId,content:t.newComment.trim()},e.n=4,m.A.comment.add(i);case 4:n=e.v,200===n.code&&(t.$message.success("è¯„è®ºå‘è¡¨æˆåŠŸ"),t.newComment="",t.getComments()),e.n=6;break;case 5:e.p=5,s=e.v,console.error("è¯„è®ºå‘è¡¨å¤±è´¥:",s),t.$message.error("è¯„è®ºå‘è¡¨å¤±è´¥");case 6:return e.p=6,t.submitting=!1,e.f(6);case 7:return e.a(2)}},e,null,[[3,5,6,7]])}))()},toggleReplyInput:function(t){this.isAuthenticated?this.replyingTo===t?this.cancelReply():(this.replyingTo=t,this.replyContent=""):this.goToLogin()},submitReply:function(t){var e=this;return(0,r.A)((0,a.A)().m(function i(){var n,s,r;return(0,a.A)().w(function(i){while(1)switch(i.p=i.n){case 0:if(e.replyContent.trim()){i.n=1;break}return e.$message.warning("å›å¤å†…å®¹ä¸èƒ½ä¸ºç©º"),i.a(2);case 1:return e.replySubmitting=!0,i.p=2,n={articleId:e.articleId,parentId:t.id,content:e.replyContent.trim(),toUserId:t.userId,level:2},i.n=3,m.A.comment.add(n);case 3:s=i.v,200===s.code&&(e.$message.success("å›å¤æˆåŠŸ"),e.cancelReply(),e.getComments()),i.n=5;break;case 4:i.p=4,r=i.v,console.error("å›å¤å¤±è´¥:",r),e.$message.error("å›å¤å¤±è´¥");case 5:return i.p=5,e.replySubmitting=!1,i.f(5);case 6:return i.a(2)}},i,null,[[2,4,5,6]])}))()},replyToChild:function(t,e){this.isAuthenticated?(this.replyingTo=t.id,this.replyContent="@".concat(e.nickname," ")):this.goToLogin()},cancelReply:function(){this.replyingTo=null,this.replyContent=""},goToLogin:function(){this.$router.push("/login")},formatTime:function(t){if(!t)return"";var e=new Date(t),i=new Date,n=i-e;return n<6e4?"åˆšåˆš":n<36e5?Math.floor(n/6e4)+"åˆ†é’Ÿå‰":n<864e5?Math.floor(n/36e5)+"å°æ—¶å‰":n<2592e6?Math.floor(n/864e5)+"å¤©å‰":"".concat(e.getFullYear(),"-").concat(String(e.getMonth()+1).padStart(2,"0"),"-").concat(String(e.getDate()).padStart(2,"0"))},handleSizeChange:function(t){this.pagination.size=t,this.pagination.current=1,this.getComments()},handleCurrentChange:function(t){this.pagination.current=t,this.getComments()}}},p=d;var h=i(81656),g=(0,h.A)(p,c,o,!1,null,"61dea156",null);const v=g.exports,C={name:"ArticleDetail",components:{CommentSection:v},data:function(){return{article:{id:null,title:"",content:"",authorName:"",createTime:"",viewCount:0,likeCount:0,commentCount:0,tags:[],status:1,userId:null},commentCount:0,liking:!1,isAdmin:!1,currentUserId:null,isLiked:!1}},computed:{isAuthor:function(){return this.currentUserId&&this.article.userId&&this.currentUserId===this.article.userId}},created:function(){this.getUserInfo(),this.getArticleDetail()},watch:{"article.id":function(t){t&&this.checkLikeStatus()}},methods:{getUserInfo:function(){var t=this;return(0,r.A)((0,a.A)().m(function e(){var i,n,s,r;return(0,a.A)().w(function(e){while(1)switch(e.p=e.n){case 0:if(e.p=0,t.$store.getters.isAuthenticated){e.n=1;break}return console.log("ç”¨æˆ·æœªç™»å½•ï¼Œæ— æ³•è·å–ç”¨æˆ·ä¿¡æ¯"),e.a(2);case 1:return e.n=2,m.A.user.getInfo();case 2:i=e.v,200===i.code&&(n=i.data,t.currentUserId=n.id,t.isAdmin=0===n.role,console.log("è·å–ç”¨æˆ·ä¿¡æ¯æˆåŠŸ:",n)),e.n=4;break;case 3:e.p=3,r=e.v,console.error("è·å–ç”¨æˆ·ä¿¡æ¯å¤±è´¥:",r),s=t.$store.getters.user,s&&(t.currentUserId=s.id,t.isAdmin=0===s.role,console.log("ä»storeè·å–ç”¨æˆ·ä¿¡æ¯:",s));case 4:return e.a(2)}},e,null,[[0,3]])}))()},getArticleDetail:function(){var t=this;return(0,r.A)((0,a.A)().m(function e(){var i,n,s,r,c;return(0,a.A)().w(function(e){while(1)switch(e.p=e.n){case 0:return e.p=0,i=t.$route.params.id,e.n=1,m.A.article.getDetail(i);case 1:n=e.v,200===n.code?(t.article=n.data,t.commentCount=t.article.commentCount||0,t.checkLikeStatus(),t.incrementViewCount()):(t.$message.error(n.message||"è·å–æ–‡ç« è¯¦æƒ…å¤±è´¥"),"æ‚¨æ— æƒæŸ¥çœ‹è¯¥æ–‡ç« "===n.message&&setTimeout(function(){t.$router.push("/article")},1500)),e.n=9;break;case 2:if(e.p=2,r=e.v,console.error("è·å–æ–‡ç« è¯¦æƒ…å¤±è´¥:",r),s="è·å–æ–‡ç« è¯¦æƒ…å¤±è´¥",!r.response){e.n=7;break}c=r.response.status,e.n=403===c?3:404===c?4:5;break;case 3:return s="æ‚¨æ— æƒæŸ¥çœ‹è¯¥æ–‡ç« ",e.a(3,6);case 4:return s="è¯·æ±‚çš„èµ„æºä¸å­˜åœ¨",e.a(3,6);case 5:s="è·å–æ–‡ç« è¯¦æƒ…å¤±è´¥: ".concat(r.message||"æœªçŸ¥é”™è¯¯");case 6:e.n=8;break;case 7:r.message&&(s="è·å–æ–‡ç« è¯¦æƒ…å¤±è´¥: ".concat(r.message));case 8:t.$message.error(s),setTimeout(function(){t.$router.push("/article")},1500);case 9:return e.a(2)}},e,null,[[0,2]])}))()},incrementViewCount:function(){return(0,r.A)((0,a.A)().m(function t(){return(0,a.A)().w(function(t){while(1)switch(t.n){case 0:case 1:return t.a(2)}},t)}))()},checkLikeStatus:function(){var t=this;return(0,r.A)((0,a.A)().m(function e(){var i,n,s;return(0,a.A)().w(function(e){while(1)switch(e.p=e.n){case 0:if(t.article.id){e.n=1;break}return e.a(2);case 1:if(i=localStorage.getItem("token"),i){e.n=2;break}return console.log("ç”¨æˆ·æœªç™»å½•ï¼Œæ— æ³•æ£€æŸ¥ç‚¹èµçŠ¶æ€"),t.isLiked=!1,e.a(2);case 2:return e.p=2,e.n=3,m.A.article.checkLikeStatus(t.article.id);case 3:n=e.v,200===n.code&&(t.isLiked=n.data,console.log("ç‚¹èµçŠ¶æ€:",t.isLiked?"å·²ç‚¹èµ":"æœªç‚¹èµ")),e.n=5;break;case 4:e.p=4,s=e.v,console.error("æ£€æŸ¥ç‚¹èµçŠ¶æ€å¤±è´¥:",s),t.isLiked=!1;case 5:return e.a(2)}},e,null,[[2,4]])}))()},toggleLike:function(){var t=this;return(0,r.A)((0,a.A)().m(function e(){var i,n,s,r,c,o;return(0,a.A)().w(function(e){while(1)switch(e.p=e.n){case 0:if(i=localStorage.getItem("token"),i){e.n=1;break}return t.$message.warning("è¯·å…ˆç™»å½•"),localStorage.setItem("redirectUrl",t.$route.fullPath),t.$router.push("/login"),e.a(2);case 1:if(e.p=1,t.liking=!0,t.$store.getters.token||t.$store.commit("SET_TOKEN",i),t.currentUserId){e.n=7;break}if(n=t.$store.getters.user,!n||!n.id){e.n=2;break}t.currentUserId=n.id,t.isAdmin=0===n.role,e.n=7;break;case 2:return e.p=2,e.n=3,t.$store.dispatch("getUserInfo");case 3:if(s=t.$store.getters.user,!s){e.n=4;break}t.currentUserId=s.id,t.isAdmin=0===s.role,e.n=5;break;case 4:throw new Error("æ— æ³•è·å–ç”¨æˆ·ä¿¡æ¯");case 5:e.n=7;break;case 6:return e.p=6,c=e.v,console.error("è·å–ç”¨æˆ·ä¿¡æ¯å¤±è´¥:",c),t.$message.error("ç™»å½•çŠ¶æ€å¼‚å¸¸ï¼Œè¯·é‡æ–°ç™»å½•"),t.$store.dispatch("logout"),localStorage.setItem("redirectUrl",t.$route.fullPath),t.$router.push("/login"),e.a(2);case 7:return e.n=8,m.A.article.like(t.article.id);case 8:r=e.v,200===r.code&&(t.isLiked=!t.isLiked,t.isLiked?(t.article.likeCount++,t.$message.success("ç‚¹èµæˆåŠŸ")):(t.article.likeCount>0&&t.article.likeCount--,t.$message.success("å·²å–æ¶ˆç‚¹èµ"))),e.n=10;break;case 9:e.p=9,o=e.v,console.error("ç‚¹èµæ“ä½œå¤±è´¥:",o),o.response?401===o.response.status||403===o.response.status?(t.$message.error("ç™»å½•å·²è¿‡æœŸï¼Œè¯·é‡æ–°ç™»å½•"),t.$store.dispatch("logout"),localStorage.setItem("redirectUrl",t.$route.fullPath),t.$router.push("/login")):t.$message.error("æ“ä½œå¤±è´¥: "+(o.message||"æœªçŸ¥é”™è¯¯")):t.$message.error("æ“ä½œå¤±è´¥: "+(o.message||"ç½‘ç»œé”™è¯¯"));case 10:return e.p=10,t.liking=!1,e.f(10);case 11:return e.a(2)}},e,null,[[2,6],[1,9,10,11]])}))()},getStatusText:function(t){switch(t){case 0:return"è‰ç¨¿";case 1:return"å·²å‘å¸ƒ";case 2:return"å¾…å®¡æ ¸";case 3:return"å®¡æ ¸ä¸é€šè¿‡";default:return"æœªçŸ¥çŠ¶æ€"}},getStatusClass:function(t){switch(t){case 0:return"status-draft";case 1:return"status-published";case 2:return"status-pending";case 3:return"status-rejected";default:return""}},approveArticle:function(){var t=this;return(0,r.A)((0,a.A)().m(function e(){var i,n;return(0,a.A)().w(function(e){while(1)switch(e.p=e.n){case 0:return e.p=0,e.n=1,m.A.article.approve(t.article.id);case 1:i=e.v,200===i.code&&(t.$message.success("å®¡æ ¸é€šè¿‡æˆåŠŸ"),t.article.status=1),e.n=3;break;case 2:e.p=2,n=e.v,t.$message.error("å®¡æ ¸æ“ä½œå¤±è´¥: "+(n.message||"æœªçŸ¥é”™è¯¯"));case 3:return e.a(2)}},e,null,[[0,2]])}))()},rejectArticle:function(){var t=this;return(0,r.A)((0,a.A)().m(function e(){var i,n;return(0,a.A)().w(function(e){while(1)switch(e.p=e.n){case 0:return e.p=0,e.n=1,m.A.article.reject(t.article.id);case 1:i=e.v,200===i.code&&(t.$message.success("å®¡æ ¸æ‹’ç»æˆåŠŸ"),t.article.status=3),e.n=3;break;case 2:e.p=2,n=e.v,t.$message.error("å®¡æ ¸æ“ä½œå¤±è´¥: "+(n.message||"æœªçŸ¥é”™è¯¯"));case 3:return e.a(2)}},e,null,[[0,2]])}))()},editArticle:function(){this.$router.push("/write?id=".concat(this.article.id))},updateCommentCount:function(t){this.commentCount=t,this.article.commentCount=t},formatDate:function(t){if(!t)return"";var e=new Date(t);return"".concat(e.getFullYear(),"-").concat(String(e.getMonth()+1).padStart(2,"0"),"-").concat(String(e.getDate()).padStart(2,"0"))}}},k=C;var f=(0,h.A)(k,n,s,!1,null,"f793be08",null);const y=f.exports}}]);
//# sourceMappingURL=9.0286d1be.js.map